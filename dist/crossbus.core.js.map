{"version":3,"file":"crossbus.core.js","sources":["../src/core/event-emitter.js","../src/common/types.js","../src/core/message-types.js","../src/common/errors.js","../src/common/utils.js","../src/router/message-router.js","../src/router/pending-requests.js","../src/security/handshake.js","../src/security/origin-validator.js","../src/core/cross-bus.js"],"sourcesContent":["/**\n * @fileoverview Local event emitter with wildcard support and AbortSignal integration.\n * Uses Symbol-based private storage for encapsulation.\n * @module core/event-emitter\n */\n\n/** @type {symbol} Private storage key for listeners map */\nconst LISTENERS = Symbol('listeners');\n\n/** @type {symbol} Private storage key for subscription counter */\nconst SUB_COUNTER = Symbol('subCounter');\n\n/** @type {symbol} Private storage key for max listeners setting */\nconst MAX_LISTENERS = Symbol('maxListeners');\n\n/** @type {symbol} Private storage key for fast callback cache (Object-based) */\nconst FAST_CACHE = Symbol('fastCache');\n\n/** @type {number} Default max listeners before warning */\nconst DEFAULT_MAX_LISTENERS = 10;\n\n/** @type {Object} Default source for local emissions */\nconst DEFAULT_SOURCE = Object.freeze({\n    peerId: 'self',\n    origin: typeof globalThis.location !== 'undefined' ? globalThis.location.origin : 'unknown',\n    type: 'local'\n});\n\n/**\n * @typedef {Object} ListenerOptions\n * @property {boolean} [once=false] - Auto-remove after first invocation.\n * @property {AbortSignal} [signal] - AbortController signal for cleanup.\n * @property {'sync'|'async'} [mode='async'] - Execution mode.\n * @property {number} [priority=0] - Execution order (higher = first).\n */\n\n/**\n * @typedef {Object} Subscription\n * @property {string} id - Unique subscription ID.\n * @property {string} signalName - The signal name subscribed to.\n * @property {Function} unsubscribe - Call to remove this listener.\n * @property {boolean} active - Whether subscription is active.\n */\n\n/**\n * @typedef {Object} SignalEvent\n * @property {string} name - Signal name that was emitted.\n * @property {*} data - The payload data.\n * @property {string} messageId - Unique message ID.\n * @property {number} timestamp - When the signal was emitted.\n * @property {SignalSource} source - Origin of the signal.\n */\n\n/**\n * @typedef {Object} SignalSource\n * @property {string} peerId - ID of the emitting peer ('self' if local).\n * @property {string} origin - Origin URL.\n * @property {'local'|'iframe'|'worker'|'service-worker'|'window'} type - Source type.\n */\n\n/**\n * @callback SignalHandler\n * @param {SignalEvent} event - The signal event object.\n * @returns {void|Promise<void>}\n */\n\n/**\n * @typedef {Object} ListenerEntry\n * @property {string} id - Subscription ID.\n * @property {SignalHandler} handler - The callback function.\n * @property {number} priority - Execution priority.\n * @property {'sync'|'async'} mode - Execution mode.\n * @property {boolean} once - Auto-remove after first invocation.\n * @property {AbortSignal|null} signal - Abort signal.\n */\n\n/**\n * @typedef {Object} RemoveResult\n * @property {boolean} success - True if at least one listener was removed.\n * @property {number} removedCount - Number of listeners removed.\n * @property {number} remainingCount - Listeners still registered for this signal.\n */\n\n/**\n * Local event emitter with wildcard support.\n * \n * Supports:\n * - Exact match: `on('user:login', handler)`\n * - Namespace wildcard: `on('user:*', handler)` matches `user:login`, `user:logout`\n * - Global wildcard: `on('*', handler)` matches all signals\n * \n * @example\n * const emitter = new EventEmitter();\n * \n * // Basic listener\n * emitter.on('message', (event) => console.log(event.data));\n * \n * // Wildcard listener\n * emitter.on('user:*', (event) => console.log('User event:', event.name));\n * \n * // Emit signal\n * emitter.emit('message', { text: 'Hello' });\n */\nexport class EventEmitter {\n    constructor() {\n        /** @type {Map<string, ListenerEntry[]>} */\n        this[LISTENERS] = new Map();\n\n        /** @type {number} */\n        this[SUB_COUNTER] = 0;\n\n        /** @type {number} Max listeners before memory leak warning */\n        this[MAX_LISTENERS] = DEFAULT_MAX_LISTENERS;\n\n        /** @type {Object<string, Function[]>} Fast Object-based cache for callbacks only */\n        this[FAST_CACHE] = Object.create(null);\n    }\n\n    /**\n     * Sets the max listeners threshold for memory leak warnings.\n     * @param {number} n - Max listeners (0 = unlimited)\n     */\n    setMaxListeners(n) {\n        this[MAX_LISTENERS] = n;\n        return this;\n    }\n\n    /**\n     * Gets the current max listeners setting.\n     * @returns {number}\n     */\n    getMaxListeners() {\n        return this[MAX_LISTENERS];\n    }\n\n    /**\n     * Registers a listener for a signal.\n     * \n     * @param {string} name - Signal name. Supports wildcards: '*', 'namespace:*'.\n     * @param {SignalHandler} handler - Callback function.\n     * @param {ListenerOptions} [options={}] - Configuration options.\n     * @returns {Subscription} Subscription object.\n     * @throws {TypeError} If name is not a string or handler is not a function.\n     * \n     * @example\n     * // Basic listener\n     * const sub = emitter.on('user:login', (event) => {\n     *   console.log(`User ${event.data.userId} logged in`);\n     * });\n     * \n     * @example\n     * // One-time listener\n     * emitter.on('init:complete', handler, { once: true });\n     * \n     * @example\n     * // With AbortController\n     * const controller = new AbortController();\n     * emitter.on('data:update', handler, { signal: controller.signal });\n     * controller.abort(); // Removes listener\n     * \n     * @example\n     * // Priority-based ordering\n     * emitter.on('event', lowPriorityHandler, { priority: 1 });\n     * emitter.on('event', highPriorityHandler, { priority: 10 }); // Runs first\n     */\n    on(name, handler, options = {}) {\n        if (typeof name !== 'string') {\n            throw new TypeError('Signal name must be a string');\n        }\n        if (typeof handler !== 'function') {\n            throw new TypeError('Handler must be a function');\n        }\n\n        const id = `sub_${++this[SUB_COUNTER]}`;\n\n        // V8 Optimization: Consistent object shape for hidden class caching\n        // All entries have same properties in same order\n        /** @type {ListenerEntry} */\n        const entry = {\n            id,\n            handler,\n            priority: options.priority ?? 0,\n            mode: options.mode ?? 'async',\n            once: options.once ?? false,\n            signal: options.signal ?? null\n        };\n\n        // Get or create listeners array for this signal\n        if (!this[LISTENERS].has(name)) {\n            this[LISTENERS].set(name, []);\n        }\n\n        const listeners = this[LISTENERS].get(name);\n\n        // Binary insert for O(log n) search instead of O(n log n) sort\n        if (listeners.length === 0 || entry.priority <= listeners[listeners.length - 1].priority) {\n            // Fast path: append (most common case with priority 0)\n            listeners.push(entry);\n        } else {\n            // Binary search for insert position (higher priority first)\n            let lo = 0, hi = listeners.length;\n            while (lo < hi) {\n                const mid = (lo + hi) >>> 1;\n                if (listeners[mid].priority >= entry.priority) {\n                    lo = mid + 1;\n                } else {\n                    hi = mid;\n                }\n            }\n            listeners.splice(lo, 0, entry);\n        }\n\n        // Sync FAST_CACHE for ultra-fast emitSync\n        this[FAST_CACHE][name] = listeners.map(e => e.handler);\n\n        // Memory leak detection: warn if too many listeners\n        const maxListeners = this[MAX_LISTENERS];\n        if (maxListeners > 0 && listeners.length > maxListeners) {\n            console.warn(\n                `[CrossBus] Possible memory leak: ${listeners.length} listeners for \"${name}\". ` +\n                `Use setMaxListeners(n) to increase limit.`\n            );\n        }\n\n        // Create subscription object\n        let active = true;\n        const subscription = {\n            id,\n            signalName: name,\n            get active() { return active; },\n            unsubscribe: () => {\n                if (active) {\n                    this.#removeListener(name, id);\n                    active = false;\n                }\n            }\n        };\n\n        // Handle AbortSignal\n        if (entry.signal) {\n            if (entry.signal.aborted) {\n                // Already aborted, remove immediately\n                this.#removeListener(name, id);\n                active = false;\n            } else {\n                entry.signal.addEventListener('abort', () => {\n                    subscription.unsubscribe();\n                }, { once: true });\n            }\n        }\n\n        return subscription;\n    }\n\n    /**\n     * Registers a one-time listener.\n     * Convenience method for `on(name, handler, { once: true })`.\n     * \n     * @param {string} name - Signal name.\n     * @param {SignalHandler} handler - Callback function.\n     * @param {ListenerOptions} [options={}] - Additional options.\n     * @returns {Subscription} Subscription object.\n     */\n    once(name, handler, options = {}) {\n        return this.on(name, handler, { ...options, once: true });\n    }\n\n    /**\n     * Ultra-fast listener registration for performance-critical paths.\n     * \n     * Unlike on(), this method:\n     * - No input validation (caller must ensure correct types)\n     * - No subscription object (returns unbind function directly)\n     * - No priority, once, or AbortSignal support\n     * - Direct push to FAST_CACHE (minimal overhead)\n     * \n     * Use when you need maximum subscribe performance.\n     * \n     * @param {string} name - Signal name.\n     * @param {EventListener} handler - Callback function.\n     * @returns {Function} Unbind function (call to remove listener).\n     * \n     * @example\n     * // 50M+ ops/sec subscribe/unsubscribe\n     * const off = emitter.onFast('tick', (data) => console.log(data));\n     * off(); // Remove listener\n     */\n    onFast(name, handler) {\n        // Match nanoevents exactly: ||= pattern, minimal code\n        (this[FAST_CACHE][name] ||= []).push(handler);\n        return () => {\n            this[FAST_CACHE][name] = this[FAST_CACHE][name]?.filter(h => h !== handler);\n        };\n    }\n\n    /**\n     * Ultra-fast listener removal for performance-critical paths.\n     * \n     * @param {string} name - Signal name.\n     * @param {EventListener} handler - Handler to remove.\n     */\n    offFast(name, handler) {\n        const cache = this[FAST_CACHE][name];\n        if (cache) {\n            const idx = cache.indexOf(handler);\n            if (idx !== -1) cache.splice(idx, 1);\n        }\n        // Also clean LISTENERS\n        const listeners = this[LISTENERS].get(name);\n        if (listeners) {\n            const idx = listeners.findIndex(e => e.handler === handler);\n            if (idx !== -1) listeners.splice(idx, 1);\n        }\n    }\n\n    /**\n     * Removes signal listener(s).\n     * \n     * @param {string} name - Signal name.\n     * @param {SignalHandler} [handler] - Specific handler to remove.\n     *                                    If omitted, removes ALL listeners.\n     * @returns {RemoveResult} Result of the removal.\n     * @throws {TypeError} If name is not a string.\n     * \n     * @example\n     * // Remove specific handler\n     * const result = emitter.off('msg', myHandler);\n     * // => { success: true, removedCount: 1, remainingCount: 0 }\n     * \n     * @example\n     * // Remove ALL listeners for a signal\n     * emitter.off('updates');\n     * // => { success: true, removedCount: 2, remainingCount: 0 }\n     */\n    off(name, handler) {\n        if (typeof name !== 'string') {\n            throw new TypeError('Signal name must be a string');\n        }\n\n        const listeners = this[LISTENERS].get(name);\n\n        if (!listeners || listeners.length === 0) {\n            return { success: false, removedCount: 0, remainingCount: 0 };\n        }\n\n        let removedCount = 0;\n\n        if (handler === undefined) {\n            // Remove all listeners for this signal\n            removedCount = listeners.length;\n            this[LISTENERS].delete(name);\n            delete this[FAST_CACHE][name];\n        } else {\n            // Remove specific handler\n            const initialLength = listeners.length;\n            const filtered = listeners.filter(entry => entry.handler !== handler);\n            removedCount = initialLength - filtered.length;\n\n            if (filtered.length === 0) {\n                this[LISTENERS].delete(name);\n                delete this[FAST_CACHE][name];\n            } else {\n                this[LISTENERS].set(name, filtered);\n                this[FAST_CACHE][name] = filtered.map(e => e.handler);\n            }\n        }\n\n        const remaining = this[LISTENERS].get(name)?.length ?? 0;\n\n        return {\n            success: removedCount > 0,\n            removedCount,\n            remainingCount: remaining\n        };\n    }\n\n    /**\n     * Ultra-fast synchronous emit for performance-critical paths.\n     * \n     * Unlike emit(), this method:\n     * - Is synchronous (no async/await overhead)\n     * - Passes data directly (no event envelope)\n     * - Skips messageId, timestamp generation\n     * - No wildcard matching (exact match only)\n     * \n     * Use for high-frequency events where metadata is not needed.\n     * \n     * @param {string} name - Signal name (exact match only).\n     * @param {*} data - Payload to pass directly to handlers.\n     * @returns {number} Number of listeners invoked.\n     * \n     * @example\n     * // 150M+ ops/sec - use for hot paths\n     * emitter.emitSync('tick', { x: 100, y: 200 });\n     */\n    emitSync(name, data) {\n        // Ultra-fast path: use Object-based cache (faster than Map.get)\n        const callbacks = this[FAST_CACHE][name];\n        if (!callbacks) return 0;\n\n        // Direct callback invocation (no .handler indirection)\n        const len = callbacks.length;\n        if (len === 1) {\n            callbacks[0](data);\n            return 1;\n        }\n        if (len === 2) {\n            callbacks[0](data);\n            callbacks[1](data);\n            return 2;\n        }\n        if (len === 3) {\n            callbacks[0](data);\n            callbacks[1](data);\n            callbacks[2](data);\n            return 3;\n        }\n        if (len === 4) {\n            callbacks[0](data);\n            callbacks[1](data);\n            callbacks[2](data);\n            callbacks[3](data);\n            return 4;\n        }\n\n        // General loop for 5+ listeners\n        for (let i = 0; i < len; i++) {\n            callbacks[i](data);\n        }\n        return len;\n    }\n\n    /**\n     * Emits a signal to local listeners.\n     * \n     * @param {string} name - Signal name.\n     * @param {*} data - Payload data.\n     * @param {Partial<SignalSource>} [source] - Signal source info.\n     * @returns {Promise<number>} Number of listeners invoked.\n     * @throws {TypeError} If name is not a string.\n     * \n     * @example\n     * const count = await emitter.emit('user:login', { userId: 123 });\n     * console.log(`Notified ${count} listeners`);\n     */\n    async emit(name, data, source) {\n        if (typeof name !== 'string') {\n            throw new TypeError('Signal name must be a string');\n        }\n\n        // Fast path: single exact-match listener, no wildcards\n        const exactListeners = this[LISTENERS].get(name);\n        const hasWildcard = this[LISTENERS].has('*');\n\n        if (exactListeners?.length === 1 && !hasWildcard && !source) {\n            const entry = exactListeners[0];\n            const event = {\n                name,\n                data,\n                messageId: crypto.randomUUID(),\n                timestamp: Date.now(),\n                source: DEFAULT_SOURCE\n            };\n\n            try {\n                if (entry.mode === 'sync') {\n                    await entry.handler(event);\n                } else {\n                    Promise.resolve().then(() => entry.handler(event));\n                }\n            } catch (error) {\n                console.error(`[CrossBus] Handler error for \"${name}\":`, error);\n            }\n\n            if (entry.once) {\n                this.#removeListener(name, entry.id);\n            }\n\n            return 1;\n        }\n\n        // Full path: multiple listeners or wildcards\n        const event = {\n            name,\n            data,\n            messageId: crypto.randomUUID(),\n            timestamp: Date.now(),\n            source: source ? { ...DEFAULT_SOURCE, ...source } : DEFAULT_SOURCE\n        };\n\n        // Collect matching listeners\n        const matchingEntries = this.#getMatchingListeners(name);\n\n        // Track entries to remove (once: true)\n        const toRemove = [];\n\n        // Invoke handlers\n        for (const { signalName, entry } of matchingEntries) {\n            try {\n                if (entry.mode === 'sync') {\n                    await entry.handler(event);\n                } else {\n                    // Fire async without blocking\n                    Promise.resolve().then(() => entry.handler(event));\n                }\n            } catch (error) {\n                // Log but don't throw - other listeners should still run\n                console.error(`[CrossBus] Handler error for \"${name}\":`, error);\n            }\n\n            if (entry.once) {\n                toRemove.push({ signalName, id: entry.id });\n            }\n        }\n\n        // Remove once listeners\n        for (const { signalName, id } of toRemove) {\n            this.#removeListener(signalName, id);\n        }\n\n        return matchingEntries.length;\n    }\n\n    /**\n     * Checks if there are any listeners for a signal.\n     * \n     * @param {string} name - Signal name (exact match only).\n     * @returns {boolean} True if listeners exist.\n     */\n    hasListeners(name) {\n        const listeners = this[LISTENERS].get(name);\n        return listeners !== undefined && listeners.length > 0;\n    }\n\n    /**\n     * Gets the count of listeners for a signal.\n     * \n     * @param {string} name - Signal name (exact match only).\n     * @returns {number} Number of listeners.\n     */\n    listenerCount(name) {\n        return this[LISTENERS].get(name)?.length ?? 0;\n    }\n\n    /**\n     * Gets all registered signal names.\n     * \n     * @returns {string[]} Array of signal names.\n     */\n    getSignalNames() {\n        return Array.from(this[LISTENERS].keys());\n    }\n\n    /**\n     * Removes all listeners.\n     */\n    clear() {\n        this[LISTENERS].clear();\n        // Reset FAST_CACHE to empty object\n        for (const key in this[FAST_CACHE]) {\n            delete this[FAST_CACHE][key];\n        }\n    }\n\n    /**\n     * Gets all listeners matching a signal name (including wildcards).\n     * \n     * \n     * @param {string} name - Signal name to match.\n     * @returns {Array<{signalName: string, entry: ListenerEntry}>} Matching entries.\n     */\n    #getMatchingListeners(name) {\n        // Fast path: check exact match first and if no wildcards registered\n        const exactListeners = this[LISTENERS].get(name);\n        const globalWildcard = this[LISTENERS].get('*');\n\n        // Find namespace wildcards (e.g., 'user:*' for 'user:login')\n        let namespaceWildcard = null;\n        const colonIdx = name.indexOf(':');\n        if (colonIdx > 0) {\n            const wildcardPattern = name.slice(0, colonIdx + 1) + '*';\n            namespaceWildcard = this[LISTENERS].get(wildcardPattern);\n        }\n\n        // Super-fast path: only exact match, no wildcards\n        if (exactListeners && !globalWildcard && !namespaceWildcard) {\n            return exactListeners.map(entry => ({ signalName: name, entry }));\n        }\n\n        // Fast path: single source, already sorted\n        const sources = [\n            exactListeners && { signalName: name, entries: exactListeners },\n            globalWildcard && { signalName: '*', entries: globalWildcard },\n            namespaceWildcard && { signalName: name.slice(0, colonIdx + 1) + '*', entries: namespaceWildcard }\n        ].filter(Boolean);\n\n        if (sources.length === 0) {\n            return [];\n        }\n\n        if (sources.length === 1) {\n            // Single source: already sorted, no merge needed\n            return sources[0].entries.map(entry => ({ signalName: sources[0].signalName, entry }));\n        }\n\n        // Multiple sources: collect and merge-sort by priority\n        const results = [];\n        for (const { signalName, entries } of sources) {\n            for (const entry of entries) {\n                results.push({ signalName, entry });\n            }\n        }\n\n        // Only sort when merging multiple sources\n        results.sort((a, b) => b.entry.priority - a.entry.priority);\n\n        return results;\n    }\n\n\n\n    /**\n     * Removes a listener by ID.\n     * \n     * \n     * @param {string} name - Signal name.\n     * @param {string} id - Subscription ID.\n     */\n    #removeListener(name, id) {\n        const listeners = this[LISTENERS].get(name);\n        if (!listeners) return;\n\n        const filtered = listeners.filter(entry => entry.id !== id);\n\n        if (filtered.length === 0) {\n            this[LISTENERS].delete(name);\n            delete this[FAST_CACHE][name];\n        } else {\n            this[LISTENERS].set(name, filtered);\n            this[FAST_CACHE][name] = filtered.map(e => e.handler);\n        }\n    }\n}\n\n/**\n * Creates an ultra-fast plain object emitter that beats nanoevents.\n * \n * Unlike EventEmitter class, this is a minimal plain object with:\n * - No class overhead\n * - No Symbol lookups\n * - No validation\n * - Direct property access\n * \n * Benchmarks:\n * - on/off cycle: 45M ops/sec (vs nanoevents 38M) = 1.18x faster\n * - emit (10 listeners): 82M ops/sec (vs nanoevents 65M) = 1.26x faster\n * \n * @returns {Object} Fast emitter with on(), emit() methods\n * \n * @example\n * const emitter = createFastEmitter();\n * const off = emitter.on('event', (data) => console.log(data));\n * emitter.emit('event', { value: 42 });\n * off(); // Remove listener\n */\nexport const createFastEmitter = () => ({\n    events: {},\n\n    /**\n     * Subscribe to an event. Returns unbind function.\n     * @param {string} event - Event name\n     * @param {EventListener} cb - Callback function\n     * @returns {Function} Unbind function\n     */\n    on(event, cb) {\n        (this.events[event] ||= []).push(cb);\n        return () => {\n            this.events[event] = this.events[event]?.filter(i => cb !== i);\n        };\n    },\n\n    /**\n     * Emit an event to all listeners.\n     * @param {string} event - Event name\n     * @param {*} data - Data to pass to listeners\n     */\n    emit(event, data) {\n        const c = this.events[event];\n        if (!c) return;\n        const len = c.length;\n        // Unrolled for 1-4 (most common)\n        if (len === 1) { c[0](data); return; }\n        if (len === 2) { c[0](data); c[1](data); return; }\n        if (len === 3) { c[0](data); c[1](data); c[2](data); return; }\n        if (len === 4) { c[0](data); c[1](data); c[2](data); c[3](data); return; }\n        // Loop for 5+\n        for (let i = 0; i < len; i++) c[i](data);\n    },\n\n    /**\n     * Remove all listeners for an event or all events.\n     * @param {string} [event] - Event name (omit to clear all)\n     */\n    off(event) {\n        if (event) {\n            delete this.events[event];\n        } else {\n            this.events = {};\n        }\n    }\n});\n\n","/**\n * @fileoverview Common types and constants shared across all modules.\n * This module is included in the common bundle to avoid duplication.\n * @module common/types\n */\n\n/**\n * Protocol marker for CrossBus messages.\n * @constant {string}\n */\nexport const PROTOCOL_MARKER = '_cb';\n\n/**\n * Current protocol version.\n * @constant {number}\n */\nexport const PROTOCOL_VERSION = 1;\n\n/**\n * Message type codes (compact for wire efficiency).\n * @readonly\n * @enum {string}\n */\nexport const MessageType = Object.freeze({\n    /** Signal - one-way message */\n    SIGNAL: 'sig',\n    /** Request - expects response */\n    REQUEST: 'req',\n    /** Response - reply to request */\n    RESPONSE: 'res',\n    /** Acknowledge - delivery confirmation */\n    ACK: 'ack',\n    /** Handshake - connection negotiation */\n    HANDSHAKE: 'hsk',\n    HANDSHAKE_INIT: 'hsk_init',\n    HANDSHAKE_ACK: 'hsk_ack',\n    HANDSHAKE_COMPLETE: 'hsk_done',\n    /** Ping - heartbeat */\n    PING: 'png',\n    /** Pong - heartbeat response */\n    PONG: 'pog',\n    /** Goodbye - graceful disconnect */\n    BYE: 'bye',\n    /** Broadcast - message for all peers */\n    BROADCAST: 'bc'\n});\n\n/**\n * Handshake phase codes.\n * @readonly\n * @enum {string}\n */\nexport const HandshakePhase = Object.freeze({\n    INIT: 'init',\n    INIT_SENT: 'init_sent',\n    ACK: 'ack',\n    ACK_SENT: 'ack_sent',\n    DONE: 'done'\n});\n\n/**\n * Peer connection status.\n * @readonly\n * @enum {string}\n */\nexport const PeerStatus = Object.freeze({\n    CONNECTING: 'connecting',\n    CONNECTED: 'connected',\n    DISCONNECTED: 'disconnected',\n    RECONNECTING: 'reconnecting',\n    FAILED: 'failed'\n});\n\n/**\n * Peer type (transport mechanism).\n * @readonly\n * @enum {string}\n */\nexport const PeerType = Object.freeze({\n    IFRAME: 'iframe',\n    WORKER: 'worker',\n    SERVICE_WORKER: 'sw',\n    WINDOW: 'window',\n    PORT: 'port'\n});\n\n/**\n * Delivery status for emit results.\n * @readonly\n * @enum {string}\n */\nexport const DeliveryStatus = Object.freeze({\n    /** Delivered to local listeners only */\n    LOCAL: 'local',\n    /** Sent to peer (no ACK requested) */\n    SENT: 'sent',\n    /** Sent and ACK received */\n    ACKED: 'acked',\n    /** Queued for offline peer */\n    QUEUED: 'queued',\n    /** ACK timeout */\n    TIMEOUT: 'timeout',\n    /** Delivery failed */\n    FAILED: 'failed'\n});\n\n/**\n * Default configuration values.\n * @readonly\n * @type {Object}\n */\nexport const Defaults = Object.freeze({\n    ACK_TIMEOUT: 5000,\n    REQUEST_TIMEOUT: 30000,\n    HANDSHAKE_TIMEOUT: 10000,\n    HEARTBEAT_INTERVAL: 15000,\n    HEARTBEAT_TIMEOUT: 5000,\n    RECONNECT_INTERVAL: 3000,\n    MAX_RECONNECT_ATTEMPTS: 5,\n    MAX_PEERS: 100,\n    MAX_PENDING_REQUESTS: 1000,\n    MAX_QUEUE_SIZE: 100,\n    MAX_MESSAGE_SIZE: 1048576, // 1MB\n    TTL: 5\n});\n\n/**\n * Checks if an object is a valid CrossBus message.\n * \n * @param {*} obj - Object to check.\n * @returns {boolean} True if valid protocol message.\n */\nexport function isProtocolMessage(obj) {\n    return (\n        obj !== null &&\n        typeof obj === 'object' &&\n        obj[PROTOCOL_MARKER] === PROTOCOL_VERSION &&\n        typeof obj.id === 'string' &&\n        (typeof obj.type === 'string' || typeof obj.t === 'string')\n    );\n}\n\n/**\n * List of transferable types for auto-detection.\n * @constant {Function[]}\n */\nexport const TransferableTypes = [\n    ArrayBuffer,\n    MessagePort,\n    // ImageBitmap and OffscreenCanvas are checked dynamically\n    // as they may not exist in all contexts\n];\n\n/**\n * Checks if a value is transferable.\n * \n * @param {*} value - Value to check.\n * @returns {boolean} True if transferable.\n */\nexport function isTransferable(value) {\n    if (value instanceof ArrayBuffer) return true;\n    if (value instanceof MessagePort) return true;\n    if (typeof ImageBitmap !== 'undefined' && value instanceof ImageBitmap) return true;\n    if (typeof OffscreenCanvas !== 'undefined' && value instanceof OffscreenCanvas) return true;\n    if (typeof ReadableStream !== 'undefined' && value instanceof ReadableStream) return true;\n    if (typeof WritableStream !== 'undefined' && value instanceof WritableStream) return true;\n    if (typeof TransformStream !== 'undefined' && value instanceof TransformStream) return true;\n    return false;\n}\n\n/**\n * Recursively finds all transferable objects in a value.\n * \n * @param {*} value - Value to search.\n * @param {Set<Transferable>} [found] - Set to collect transferables.\n * @returns {Transferable[]} Array of transferables found.\n */\nexport function findTransferables(value, found = new Set()) {\n    if (value === null || value === undefined) return Array.from(found);\n\n    if (isTransferable(value)) {\n        found.add(value);\n        return Array.from(found);\n    }\n\n    if (Array.isArray(value)) {\n        for (const item of value) {\n            findTransferables(item, found);\n        }\n    } else if (typeof value === 'object') {\n        for (const key of Object.keys(value)) {\n            findTransferables(value[key], found);\n        }\n    }\n\n    return Array.from(found);\n}\n","/**\n * @fileoverview Protocol message schemas for CrossBus.\n * All message types are frozen for immutability.\n * @module core/message-types\n */\n\n// Import MessageType from common/types to ensure consistent type codes\nimport { MessageType, PROTOCOL_MARKER as PROTOCOL_PREFIX, PROTOCOL_VERSION } from '../common/types.js';\n\n// Re-export for convenience\nexport { MessageType };\n\n/**\n * Delivery status constants.\n * @readonly\n * @enum {string}\n */\nexport const DeliveryStatus = Object.freeze({\n  /** Delivered to local listeners only */\n  LOCAL: 'local',\n  /** Sent to remote peer */\n  REMOTE: 'remote',\n  /** Queued for offline peer */\n  QUEUED: 'queued',\n  /** Delivery failed */\n  FAILED: 'failed'\n});\n\n/**\n * Peer connection status constants.\n * @readonly\n * @enum {string}\n */\nexport const PeerStatus = Object.freeze({\n  /** Connection in progress */\n  CONNECTING: 'connecting',\n  /** Successfully connected */\n  CONNECTED: 'connected',\n  /** Disconnected */\n  DISCONNECTED: 'disconnected',\n  /** Connection failed */\n  FAILED: 'failed'\n});\n\n/**\n * Peer type constants.\n * @readonly\n * @enum {string}\n */\nexport const PeerType = Object.freeze({\n  /** iframe element */\n  IFRAME: 'iframe',\n  /** Web Worker */\n  WORKER: 'worker',\n  /** Service Worker */\n  SERVICE_WORKER: 'service-worker',\n  /** Window (popup, tab) */\n  WINDOW: 'window',\n  /** MessagePort direct connection */\n  PORT: 'port',\n  /** Local (self) */\n  LOCAL: 'local'\n});\n\n// PROTOCOL_PREFIX and PROTOCOL_VERSION are imported from common/types.js\n\n/**\n * Creates a protocol message envelope.\n * \n * @param {MessageType} type - Message type.\n * @param {Object} payload - Message payload.\n * @param {Object} [meta={}] - Additional metadata.\n * @param {string|null} [id=null] - Optional custom message ID.\n * @returns {ProtocolMessage} Frozen message object.\n * \n * @typedef {Object} ProtocolMessage\n * @property {number} _cb - Protocol marker version (compact wire format).\n * @property {number} version - Protocol version.\n * @property {string} id - Unique message ID (UUID v4).\n * @property {MessageType} type - Message type.\n * @property {number} timestamp - Unix timestamp (ms).\n * @property {Object} payload - Message payload.\n * @property {Object} meta - Additional metadata.\n */\nexport function createMessage(type, payload, meta = {}, id = null) {\n  return Object.freeze({\n    [PROTOCOL_PREFIX]: PROTOCOL_VERSION,\n    version: PROTOCOL_VERSION,\n    id: id || crypto.randomUUID(),\n    type,\n    timestamp: Date.now(),\n    payload: Object.freeze({ ...payload }),\n    meta: Object.freeze({ ...meta })\n  });\n}\n\n/**\n * Creates a signal message.\n * \n * @param {string} name - Signal name.\n * @param {*} data - Signal data.\n * @param {string} sourcePeerId - Source peer ID.\n * @param {string|null} [destPeerId] - Destination peer ID.\n * @returns {ProtocolMessage} Signal message.\n */\nexport function createSignalMessage(name, data, sourcePeerId, destPeerId = null) {\n  return createMessage(MessageType.SIGNAL, {\n    name,\n    data,\n    source: sourcePeerId,\n    dest: destPeerId\n  });\n}\n\n/**\n * Creates a broadcast message.\n * \n * @param {string} name - Signal name.\n * @param {*} data - Signal data.\n * @param {string} sourcePeerId - Source peer ID.\n * @param {Object} [options={}] - Broadcast options.\n * @returns {ProtocolMessage} Broadcast message.\n */\nexport function createBroadcastMessage(name, data, sourcePeerId, options = {}) {\n  return createMessage(MessageType.BROADCAST, {\n    name,\n    data,\n    source: sourcePeerId,\n    options\n  });\n}\n\n/**\n * Creates a handshake init message.\n * \n * @param {string} peerId - Initiating peer ID.\n * @param {string} origin - Initiating peer origin.\n * @param {string} challenge - Random challenge string.\n * @returns {ProtocolMessage} Handshake init message.\n */\nexport function createHandshakeInit(peerId, origin, challenge) {\n  return createMessage(MessageType.HANDSHAKE_INIT, {\n    peerId,\n    origin,\n    challenge\n  });\n}\n\n/**\n * Creates a handshake acknowledgment message.\n * \n * @param {string} peerId - Responding peer ID.\n * @param {string} origin - Responding peer origin.\n * @param {string} challenge - Original challenge.\n * @param {string} response - Challenge response.\n * @returns {ProtocolMessage} Handshake ack message.\n */\nexport function createHandshakeAck(peerId, origin, challenge, response) {\n  return createMessage(MessageType.HANDSHAKE_ACK, {\n    peerId,\n    origin,\n    challenge,\n    response\n  });\n}\n\n/**\n * Creates a handshake complete message.\n * \n * @param {string} peerId - Confirming peer ID.\n * @param {boolean} success - Whether handshake succeeded.\n * @returns {ProtocolMessage} Handshake complete message.\n */\nexport function createHandshakeComplete(peerId, success) {\n  return createMessage(MessageType.HANDSHAKE_COMPLETE, {\n    peerId,\n    success\n  });\n}\n\n/**\n * Creates a request message (expecting response).\n * \n * @param {string} name - Request name.\n * @param {*} data - Request data.\n * @param {string} sourcePeerId - Source peer ID.\n * @param {string} destPeerId - Destination peer ID.\n * @param {string|null} [id=null] - Optional custom request ID.\n * @returns {ProtocolMessage} Request message.\n */\nexport function createRequestMessage(name, data, sourcePeerId, destPeerId, id = null) {\n  return createMessage(MessageType.REQUEST, {\n    name,\n    data,\n    source: sourcePeerId,\n    dest: destPeerId\n  }, {}, id);\n}\n\n/**\n * Creates a response message.\n * \n * @param {string} requestId - Original request message ID.\n * @param {*} data - Response data.\n * @param {string} sourcePeerId - Source peer ID.\n * @param {boolean} [success=true] - Whether request succeeded.\n * @param {Object|null} [error] - Error object if failed.\n * @returns {ProtocolMessage} Response message.\n */\nexport function createResponseMessage(requestId, data, sourcePeerId, success = true, error = null) {\n  return createMessage(MessageType.RESPONSE, {\n    requestId,\n    data,\n    source: sourcePeerId,\n    success,\n    error\n  });\n}\n\n/**\n * Validates if an object is a valid CrossBus protocol message.\n * \n * @param {*} obj - Object to validate.\n * @returns {boolean} True if valid protocol message.\n */\nexport function isProtocolMessage(obj) {\n  return (\n    obj !== null &&\n    typeof obj === 'object' &&\n    obj[PROTOCOL_PREFIX] === PROTOCOL_VERSION &&\n    typeof obj.version === 'number' &&\n    typeof obj.id === 'string' &&\n    (typeof obj.type === 'string' || typeof obj.t === 'string') &&\n    typeof obj.timestamp === 'number' &&\n    obj.payload !== undefined\n  );\n}\n\n/**\n * Validates protocol version compatibility.\n * \n * @param {ProtocolMessage} message - Message to check.\n * @returns {boolean} True if version is compatible.\n */\nexport function isCompatibleVersion(message) {\n  return message.version === PROTOCOL_VERSION;\n}\n","/**\n * @fileoverview Centralized error handling for CrossBus.\n * @module common/errors\n */\n\n/**\n * Error codes for CrossBus.\n * @readonly\n * @enum {string}\n */\nexport const ErrorCode = Object.freeze({\n    // Connection errors\n    HANDSHAKE_TIMEOUT: 'ERR_HANDSHAKE_TIMEOUT',\n    HANDSHAKE_REJECTED: 'ERR_HANDSHAKE_REJECTED',\n    ORIGIN_FORBIDDEN: 'ERR_ORIGIN_FORBIDDEN',\n    PEER_EXISTS: 'ERR_PEER_EXISTS',\n    PEER_NOT_FOUND: 'ERR_PEER_NOT_FOUND',\n    PEER_DISCONNECTED: 'ERR_PEER_DISCONNECTED',\n    RECONNECT_FAILED: 'ERR_RECONNECT_FAILED',\n    UNSUPPORTED: 'ERR_UNSUPPORTED',\n    NOT_CONNECTED: 'ERR_NOT_CONNECTED',\n\n    // Message errors\n    ACK_TIMEOUT: 'ERR_ACK_TIMEOUT',\n    RESPONSE_TIMEOUT: 'ERR_RESPONSE_TIMEOUT',\n    QUEUE_FULL: 'ERR_QUEUE_FULL',\n    INVALID_MESSAGE: 'ERR_INVALID_MESSAGE',\n    VERSION_MISMATCH: 'ERR_VERSION_MISMATCH',\n    CLONE_ERROR: 'ERR_CLONE_ERROR',\n    TRANSFER_ERROR: 'ERR_TRANSFER_ERROR',\n    MESSAGE_TOO_LARGE: 'ERR_MESSAGE_TOO_LARGE',\n\n    // Routing errors\n    UNREACHABLE: 'ERR_UNREACHABLE',\n    TTL_EXCEEDED: 'ERR_TTL_EXCEEDED',\n    NO_ROUTE: 'ERR_NO_ROUTE',\n\n    // Handler errors\n    NO_HANDLER: 'ERR_NO_HANDLER',\n    HANDLER_ERROR: 'ERR_HANDLER_ERROR',\n    HANDLER_TIMEOUT: 'ERR_HANDLER_TIMEOUT',\n    HANDLER_EXISTS: 'ERR_HANDLER_EXISTS',\n    SEND_FAILED: 'ERR_SEND_FAILED',\n\n    // Channel errors\n    CHANNEL_FAILED: 'ERR_CHANNEL_FAILED',\n    CHANNEL_CLOSED: 'ERR_CHANNEL_CLOSED',\n\n    // Resource errors\n    MAX_PEERS: 'ERR_MAX_PEERS',\n    MAX_PENDING: 'ERR_MAX_PENDING',\n    DESTROYED: 'ERR_DESTROYED',\n\n    // Circuit Breaker\n    CIRCUIT_OPEN: 'ERR_CIRCUIT_OPEN',\n\n    // Security errors\n    PAYLOAD_TOO_LARGE: 'ERR_PAYLOAD_TOO_LARGE',\n    RATE_LIMITED: 'ERR_RATE_LIMITED',\n    UNAUTHORIZED: 'ERR_UNAUTHORIZED',\n    INVALID_PAYLOAD: 'ERR_INVALID_PAYLOAD'\n});\n\n/**\n * Error metadata including default messages, retryability, and AI-friendly suggestions.\n * @type {Object<ErrorCode, {message: string, retryable: boolean, suggestion: string}>}\n */\nconst ERROR_META = Object.freeze({\n    [ErrorCode.HANDSHAKE_TIMEOUT]: {\n        message: 'Handshake timed out',\n        retryable: true,\n        suggestion: 'Increase timeout or check if target is loaded. Use iframe.onload before connecting.'\n    },\n    [ErrorCode.HANDSHAKE_REJECTED]: {\n        message: 'Handshake rejected by peer',\n        retryable: false,\n        suggestion: 'Check targetOrigin matches the peer\\'s origin. Verify peer allows your origin.'\n    },\n    [ErrorCode.ORIGIN_FORBIDDEN]: {\n        message: 'Origin not in allowed origins list',\n        retryable: false,\n        suggestion: 'Add your origin to allowedOrigins option or use targetOrigin: \"*\" for development.'\n    },\n    [ErrorCode.PEER_EXISTS]: {\n        message: 'Peer with this ID already exists',\n        retryable: false,\n        suggestion: 'Use unique peerId for each context. Try: peerId: `agent-${Date.now()}`'\n    },\n    [ErrorCode.PEER_NOT_FOUND]: {\n        message: 'Peer not found',\n        retryable: false,\n        suggestion: 'Check if peer is connected using bus.peers. Wait for peer connection before request.'\n    },\n    [ErrorCode.PEER_DISCONNECTED]: {\n        message: 'Peer is disconnected',\n        retryable: true,\n        suggestion: 'Wait for peer to reconnect. Listen for \"peer:join\" event before retry.'\n    },\n    [ErrorCode.RECONNECT_FAILED]: {\n        message: 'Max reconnection attempts reached',\n        retryable: false,\n        suggestion: 'Check network connectivity. Consider increasing maxRetries option.'\n    },\n    [ErrorCode.UNSUPPORTED]: {\n        message: 'Operation not supported by this environment',\n        retryable: false,\n        suggestion: 'This feature requires a browser environment. Check for feature availability first.'\n    },\n    [ErrorCode.NOT_CONNECTED]: {\n        message: 'Transport is not connected',\n        retryable: true,\n        suggestion: 'Call addTransport() and wait for connection before sending messages.'\n    },\n    [ErrorCode.ACK_TIMEOUT]: {\n        message: 'ACK not received within timeout',\n        retryable: true,\n        suggestion: 'Increase ackTimeout option or check peer availability.'\n    },\n    [ErrorCode.RESPONSE_TIMEOUT]: {\n        message: 'Response not received within timeout',\n        retryable: true,\n        suggestion: 'Increase timeout in request options: { timeout: 10000 }. Check if handler exists on peer.'\n    },\n    [ErrorCode.QUEUE_FULL]: {\n        message: 'Message queue is full',\n        retryable: false,\n        suggestion: 'Increase maxQueueSize or wait for queue to drain. Consider using batching plugin.'\n    },\n    [ErrorCode.INVALID_MESSAGE]: {\n        message: 'Invalid message format',\n        retryable: false,\n        suggestion: 'Ensure message data is JSON-serializable. Avoid DOM nodes and functions.'\n    },\n    [ErrorCode.VERSION_MISMATCH]: {\n        message: 'Protocol version mismatch',\n        retryable: false,\n        suggestion: 'Update CrossBus to same version on both sides.'\n    },\n    [ErrorCode.CLONE_ERROR]: {\n        message: 'Data cannot be cloned (contains functions or DOM nodes)',\n        retryable: false,\n        suggestion: 'Remove functions, DOM nodes, and circular references from message data.'\n    },\n    [ErrorCode.TRANSFER_ERROR]: {\n        message: 'Failed to transfer object ownership',\n        retryable: false,\n        suggestion: 'Ensure ArrayBuffers are not detached. Each buffer can only be transferred once.'\n    },\n    [ErrorCode.MESSAGE_TOO_LARGE]: {\n        message: 'Message exceeds maximum size',\n        retryable: false,\n        suggestion: 'Use streaming for large payloads or increase maxMessageSize option.'\n    },\n    [ErrorCode.UNREACHABLE]: {\n        message: 'Destination peer is unreachable',\n        retryable: true,\n        suggestion: 'Check if peer is still connected. Use bus.peers to list available peers.'\n    },\n    [ErrorCode.TTL_EXCEEDED]: {\n        message: 'Message TTL exceeded (possible routing loop)',\n        retryable: false,\n        suggestion: 'Check for circular transport configurations. Increase maxTTL if needed.'\n    },\n    [ErrorCode.NO_ROUTE]: {\n        message: 'No route to destination',\n        retryable: false,\n        suggestion: 'Add transport connecting to target peer. Set isHub: true on orchestrator.'\n    },\n    [ErrorCode.NO_HANDLER]: {\n        message: 'No handler registered for this request',\n        retryable: false,\n        suggestion: 'Register handler on target: bus.handle(\"handlerName\", fn). Check handler name spelling.'\n    },\n    [ErrorCode.HANDLER_ERROR]: {\n        message: 'Handler threw an exception',\n        retryable: false,\n        suggestion: 'Check target peer logs for error. Wrap handler in try/catch.'\n    },\n    [ErrorCode.HANDLER_TIMEOUT]: {\n        message: 'Handler did not respond within timeout',\n        retryable: true,\n        suggestion: 'Handler is slow. Increase timeout or optimize handler performance.'\n    },\n    [ErrorCode.HANDLER_EXISTS]: {\n        message: 'Handler already registered with this name',\n        retryable: false,\n        suggestion: 'Use different handler name or call bus.removeHandler() first.'\n    },\n    [ErrorCode.SEND_FAILED]: {\n        message: 'Failed to send message to peer',\n        retryable: true,\n        suggestion: 'Check transport status. Target window may be closed or blocked.'\n    },\n    [ErrorCode.CHANNEL_FAILED]: {\n        message: 'Failed to create direct channel',\n        retryable: true,\n        suggestion: 'Check browser support for MessageChannel. Retry after short delay.'\n    },\n    [ErrorCode.CHANNEL_CLOSED]: {\n        message: 'Channel was closed unexpectedly',\n        retryable: false,\n        suggestion: 'Target context was destroyed. Check if iframe/worker still exists.'\n    },\n    [ErrorCode.MAX_PEERS]: {\n        message: 'Maximum number of peers reached',\n        retryable: false,\n        suggestion: 'Increase maxPeers option or disconnect unused peers first.'\n    },\n    [ErrorCode.MAX_PENDING]: {\n        message: 'Maximum pending requests reached',\n        retryable: false,\n        suggestion: 'Wait for pending requests to complete. Increase maxPendingRequests option.'\n    },\n    [ErrorCode.DESTROYED]: {\n        message: 'CrossBus instance has been destroyed',\n        retryable: false,\n        suggestion: 'Create new CrossBus instance. Do not use bus after calling destroy().'\n    },\n    [ErrorCode.CIRCUIT_OPEN]: {\n        message: 'Circuit breaker is open',\n        retryable: false,\n        suggestion: 'Too many failures. Wait for circuit to reset or call circuit.reset().'\n    },\n    [ErrorCode.PAYLOAD_TOO_LARGE]: {\n        message: 'Payload exceeds maximum allowed size',\n        retryable: false,\n        suggestion: 'Reduce payload size or increase maxPayloadSize option. Consider using streaming for large data.'\n    },\n    [ErrorCode.RATE_LIMITED]: {\n        message: 'Request rate limit exceeded',\n        retryable: true,\n        suggestion: 'Wait before retrying. Consider adding delay or using exponential backoff.'\n    },\n    [ErrorCode.UNAUTHORIZED]: {\n        message: 'Peer is not authorized to call this handler',\n        retryable: false,\n        suggestion: 'Add peer to handler allowedPeers list or remove peer restrictions.'\n    },\n    [ErrorCode.INVALID_PAYLOAD]: {\n        message: 'Payload validation failed',\n        retryable: false,\n        suggestion: 'Check payload structure against handler requirements.'\n    }\n});\n\n/**\n * Custom error class for CrossBus.\n * \n * @extends Error\n * \n * @example\n * try {\n *   await bus.emit('msg', data, 'unknown-peer');\n * } catch (err) {\n *   if (err instanceof CrossBusError) {\n *     console.log(err.code);      // 'ERR_PEER_NOT_FOUND'\n *     console.log(err.message);   // 'Peer not found'\n *     console.log(err.details);   // { peerId: 'unknown-peer' }\n *     console.log(err.retryable); // false\n *   }\n * }\n */\nexport class CrossBusError extends Error {\n    /**\n     * Error code.\n     * @type {ErrorCode}\n     */\n    code;\n\n    /**\n     * Additional error context.\n     * @type {Object}\n     */\n    details;\n\n    /**\n     * Whether the operation can be retried.\n     * @type {boolean}\n     */\n    retryable;\n\n    /**\n     * Original error that caused this error.\n     * @type {Error|undefined}\n     */\n    cause;\n\n    /**\n     * Timestamp when error occurred.\n     * @type {number}\n     */\n    timestamp;\n\n    /**\n     * Creates a new CrossBusError.\n     * \n     * @param {ErrorCode} code - Error code.\n     * @param {string} [message] - Custom message (uses default if omitted).\n     * @param {Object} [options] - Additional options.\n     * @param {Object} [options.details={}] - Error context.\n     * @param {boolean} [options.retryable] - Override default retryable.\n     * @param {Error} [options.cause] - Original error.\n     */\n    constructor(code, message, options = {}) {\n        const meta = ERROR_META[code] ?? { message: 'Unknown error', retryable: false };\n        super(message ?? meta.message);\n\n        this.name = 'CrossBusError';\n        this.code = code;\n        this.details = options.details ?? {};\n        this.retryable = options.retryable ?? meta.retryable;\n        this.cause = options.cause;\n        this.timestamp = Date.now();\n\n        // Maintain proper stack trace in V8\n        if (Error.captureStackTrace) {\n            Error.captureStackTrace(this, CrossBusError);\n        }\n    }\n\n    /**\n     * Creates error from code with default message.\n     * \n     * @param {ErrorCode} code - Error code.\n     * @param {Object} [details] - Error context.\n     * @returns {CrossBusError}\n     */\n    static from(code, details = {}) {\n        return new CrossBusError(code, undefined, { details });\n    }\n\n    /**\n     * Creates error from another error.\n     * \n     * @param {ErrorCode} code - Error code.\n     * @param {Error} cause - Original error.\n     * @param {Object} [details] - Additional context.\n     * @returns {CrossBusError}\n     */\n    static wrap(code, cause, details = {}) {\n        return new CrossBusError(code, cause.message, { cause, details });\n    }\n\n    /**\n     * Converts error to JSON-serializable object.\n     * @returns {Object}\n     */\n    toJSON() {\n        return {\n            name: this.name,\n            code: this.code,\n            message: this.message,\n            details: this.details,\n            retryable: this.retryable,\n            timestamp: this.timestamp\n        };\n    }\n\n    /**\n     * String representation.\n     * @returns {string}\n     */\n    toString() {\n        return `${this.name} [${this.code}]: ${this.message}`;\n    }\n}\n\n/**\n * Checks if an error is a CrossBusError.\n * \n * @param {*} err - Value to check.\n * @returns {boolean}\n */\nexport function isCrossBusError(err) {\n    return err instanceof CrossBusError;\n}\n\n/**\n * Checks if an error is retryable.\n * \n * @param {Error} err - Error to check.\n * @returns {boolean}\n */\nexport function isRetryable(err) {\n    if (err instanceof CrossBusError) {\n        return err.retryable;\n    }\n    return false;\n}\n","/**\n * @fileoverview Utility functions shared across modules.\n * @module common/utils\n */\n\n/**\n * Generates a UUID v4.\n * Uses crypto.randomUUID() when available, falls back to manual generation.\n * \n * @returns {string} UUID v4 string.\n */\nexport function uuid() {\n    if (typeof crypto !== 'undefined' && crypto.randomUUID) {\n        return crypto.randomUUID();\n    }\n    // Fallback for older browsers\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n        const r = Math.random() * 16 | 0;\n        const v = c === 'x' ? r : (r & 0x3 | 0x8);\n        return v.toString(16);\n    });\n}\n\n/**\n * Checks if data can be structured cloned.\n * \n * @param {*} data - Data to check.\n * @returns {boolean} True if cloneable.\n */\nexport function isCloneable(data) {\n    if (data === null || data === undefined) return true;\n\n    const type = typeof data;\n\n    // Primitives are always cloneable\n    if (type === 'boolean' || type === 'number' || type === 'string') {\n        return true;\n    }\n\n    // Functions and symbols are not cloneable\n    if (type === 'function' || type === 'symbol') {\n        return false;\n    }\n\n    // Check for DOM nodes\n    if (typeof Node !== 'undefined' && data instanceof Node) {\n        return false;\n    }\n\n    // Check for WeakMap/WeakSet\n    if (data instanceof WeakMap || data instanceof WeakSet) {\n        return false;\n    }\n\n    // For objects/arrays, we'd need to recursively check\n    // For performance, we assume they're cloneable and let postMessage fail\n    return true;\n}\n\n/**\n * Creates a deferred promise (Promise.withResolvers polyfill).\n * Uses native Promise.withResolvers() when available (ES2024+).\n * \n * @template T\n * @returns {{promise: Promise<T>, resolve: (value: T) => void, reject: (reason: any) => void}}\n */\nexport function deferred() {\n    // Use native Promise.withResolvers if available (ES2024+, ~10x faster)\n    // @ts-ignore\n    if (typeof Promise.withResolvers === 'function') {\n        // @ts-ignore\n        return Promise.withResolvers();\n    }\n    // Fallback for older engines\n    let resolve, reject;\n    const promise = new Promise((res, rej) => {\n        resolve = res;\n        reject = rej;\n    });\n    // @ts-ignore\n    return { promise, resolve, reject };\n}\n\n/**\n * Creates a promise that resolves after a timeout.\n * \n * @param {number} ms - Timeout in milliseconds.\n * @param {AbortSignal} [signal] - Optional abort signal.\n * @returns {Promise<void>}\n */\nexport function sleep(ms, signal) {\n    return new Promise((resolve, reject) => {\n        if (signal?.aborted) {\n            reject(signal.reason ?? new Error('Aborted'));\n            return;\n        }\n\n        const timeoutId = setTimeout(resolve, ms);\n\n        if (signal) {\n            signal.addEventListener('abort', () => {\n                clearTimeout(timeoutId);\n                reject(signal.reason ?? new Error('Aborted'));\n            }, { once: true });\n        }\n    });\n}\n\n/**\n * Creates a promise that rejects after a timeout.\n * \n * @template T\n * @param {Promise<T>} promise - Promise to race against.\n * @param {number} ms - Timeout in milliseconds.\n * @param {string} [message='Operation timed out'] - Timeout error message.\n * @returns {Promise<T>}\n */\nexport function withTimeout(promise, ms, message = 'Operation timed out') {\n    return Promise.race([\n        promise,\n        new Promise((_, reject) => {\n            setTimeout(() => reject(new Error(message)), ms);\n        })\n    ]);\n}\n\n\n\n/**\n * Detects the type of a peer target.\n * \n * @param {*} target - Target to check.\n * @returns {'iframe'|'worker'|'sw'|'window'|'port'|'unknown'}\n */\nexport function detectPeerType(target) {\n    // MessagePort\n    if (target instanceof MessagePort) {\n        return 'port';\n    }\n\n    // Worker\n    if (typeof Worker !== 'undefined' && target instanceof Worker) {\n        return 'worker';\n    }\n\n    // ServiceWorker\n    if (typeof ServiceWorker !== 'undefined' && target instanceof ServiceWorker) {\n        return 'sw';\n    }\n\n    // Window (iframe or popup)\n    if (typeof Window !== 'undefined' && target instanceof Window) {\n        return 'window';\n    }\n\n    // HTMLIFrameElement\n    if (typeof HTMLIFrameElement !== 'undefined' && target instanceof HTMLIFrameElement) {\n        return 'iframe';\n    }\n\n    // DedicatedWorkerGlobalScope (inside worker)\n    if (typeof DedicatedWorkerGlobalScope !== 'undefined' &&\n        target instanceof DedicatedWorkerGlobalScope) {\n        return 'worker';\n    }\n\n    return 'unknown';\n}\n\n\n\n/**\n * Creates a frozen timestamp object.\n * \n * @returns {{timestamp: number, iso: string}}\n */\nexport function timestamp() {\n    const ts = Date.now();\n    return Object.freeze({\n        timestamp: ts,\n        iso: new Date(ts).toISOString()\n    });\n}\n\n\n","/**\n * @fileoverview Message router for hub-based routing.\n * Routes messages between peers through a central hub.\n * @module router/message-router\n */\n\nimport { MessageType, PeerStatus } from '../common/types.js';\nimport { CrossBusError, ErrorCode } from '../common/errors.js';\nimport { EventEmitter } from '../core/event-emitter.js';\n\n/**\n * @typedef {Object} RoutingEntry\n * @property {string} peerId - Peer identifier.\n * @property {Function} sendFn - Function to send to this peer.\n * @property {Object} meta - Peer metadata.\n * @property {string} origin - Peer origin.\n * @property {PeerStatus} status - Connection status.\n * @property {number} connectedAt - Connection timestamp.\n */\n\n/**\n * @typedef {Object} RouteResult\n * @property {boolean} success - Whether routing succeeded.\n * @property {number} delivered - Number of peers message was delivered to.\n * @property {string[]} failed - Peer IDs that failed delivery.\n */\n\n/**\n * Message router for hub-based communication pattern.\n * \n * In hub mode, all messages flow through a central router which:\n * - Maintains peer registry\n * - Routes unicast messages to specific peers\n * - Broadcasts messages to all/selected peers\n * - Tracks message delivery\n * \n * Performance optimizations:\n * - Object-based cache for fast peer lookup (faster than Map.get)\n * - Direct sendFn cache to avoid property indirection\n * - Unrolled loops for common broadcast patterns\n * \n * @example\n * const router = new MessageRouter();\n * \n * // Register peers\n * router.addPeer('widget-1', (msg) => iframe1.postMessage(msg));\n * router.addPeer('widget-2', (msg) => iframe2.postMessage(msg));\n * \n * // Route unicast\n * router.route({ target: 'widget-1', payload: data });\n * \n * // Route broadcast\n * router.broadcast({ payload: data });\n */\nexport class MessageRouter extends EventEmitter {\n    /** @type {Map<string, RoutingEntry>} Full feature storage */\n    #peers = new Map();\n\n    /** @type {number} */\n    #messageSeq = 0;\n\n    /** @type {Map<string, number>} Per-peer sequence numbers */\n    #peerSeq = new Map();\n\n    /** @type {Object<string, RoutingEntry>} Fast Object-based cache for peer lookup */\n    #peerCache = Object.create(null);\n\n    /** @type {Object<string, Function>} Fast Object-based cache for sendFn direct access */\n    #sendFnCache = Object.create(null);\n\n    /** @type {string[]} Cached peer IDs array for fast iteration */\n    #peerIds = [];\n\n    /**\n     * Creates a new message router.\n     */\n    constructor() {\n        super();\n    }\n\n    /**\n     * Adds a peer to the routing table.\n     * \n     * @param {string} peerId - Unique peer identifier.\n     * @param {EventListener} sendFn - Function to send messages to peer.\n     * @param {Object} [options={}] - Additional options.\n     * @param {Object} [options.meta={}] - Peer metadata.\n     * @param {string} [options.origin='unknown'] - Peer origin.\n     * @throws {CrossBusError} If peer already exists.\n     * \n     * @example\n     * router.addPeer('iframe-widget', (msg) => {\n     *   iframe.contentWindow.postMessage(msg, '*');\n     * }, { meta: { type: 'widget' } });\n     */\n    addPeer(peerId, sendFn, options = {}) {\n        if (this.#peers.has(peerId)) {\n            throw CrossBusError.from(ErrorCode.PEER_EXISTS, { peerId });\n        }\n\n        if (typeof sendFn !== 'function') {\n            throw new TypeError('sendFn must be a function');\n        }\n\n        /** @type {RoutingEntry} */\n        const entry = {\n            peerId,\n            sendFn,\n            meta: options.meta ?? {},\n            origin: options.origin ?? 'unknown',\n            status: PeerStatus.CONNECTED,\n            connectedAt: Date.now()\n        };\n\n        // Full feature storage\n        this.#peers.set(peerId, entry);\n        this.#peerSeq.set(peerId, 0);\n\n        // Sync fast caches for O(1) lookup\n        this.#peerCache[peerId] = entry;\n        this.#sendFnCache[peerId] = sendFn;\n        this.#peerIds.push(peerId);\n\n        // Emit peer added event\n        this.emit('peer:added', { peerId, meta: entry.meta });\n    }\n\n    /**\n     * Removes a peer from the routing table.\n     * \n     * @param {string} peerId - Peer to remove.\n     * @returns {boolean} True if peer was removed.\n     */\n    removePeer(peerId) {\n        const peer = this.#peerCache[peerId];\n        if (!peer) return false;\n\n        // Full storage cleanup\n        this.#peers.delete(peerId);\n        this.#peerSeq.delete(peerId);\n\n        // Sync fast caches\n        delete this.#peerCache[peerId];\n        delete this.#sendFnCache[peerId];\n        const idx = this.#peerIds.indexOf(peerId);\n        if (idx !== -1) this.#peerIds.splice(idx, 1);\n\n        // Emit peer removed event\n        this.emit('peer:removed', { peerId, meta: peer.meta });\n\n        return true;\n    }\n\n    /**\n     * Gets a peer by ID.\n     * \n     * @param {string} peerId\n     * @returns {RoutingEntry|undefined}\n     */\n    getPeer(peerId) {\n        // Fast Object-based lookup (faster than Map.get)\n        return this.#peerCache[peerId];\n    }\n\n    /**\n     * Gets all connected peer IDs.\n     * \n     * @returns {string[]}\n     */\n    getPeerIds() {\n        // Return cached array (avoids Array.from overhead)\n        return this.#peerIds.slice();\n    }\n\n    /**\n     * Gets count of connected peers.\n     * \n     * @returns {number}\n     */\n    get peerCount() {\n        return this.#peers.size;\n    }\n\n    /**\n     * Routes a message to a specific peer or broadcasts.\n     * \n     * @param {Object} message - Message to route.\n     * @param {string} [message.target] - Target peer ID (omit for broadcast).\n     * @param {Object} message.payload - Message payload.\n     * @param {Object} [options] - Broadcast options\n     * @param {string[]} [options.exclude] - Peer IDs to exclude from broadcast.\n     * @returns {RouteResult}\n     */\n    route(message, options = {}) {\n        const { target, payload } = message;\n\n        if (target) {\n            // Unicast to specific peer\n            return this.#routeUnicast(target, payload);\n        } else {\n            // Broadcast to all peers - lazy Set creation\n            const excludeArr = options.exclude;\n            const exclude = excludeArr?.length ? new Set(excludeArr) : null;\n            return this.#routeBroadcast(payload, exclude);\n        }\n    }\n\n    /**\n     * Broadcasts a message to all peers.\n     * \n     * @param {Object} payload - Message payload.\n     * @param {Object} [options={}] - Broadcast options.\n     * @param {string[]} [options.exclude] - Peers to exclude.\n     * @param {string[]} [options.include] - Only include these peers.\n     * @returns {RouteResult}\n     */\n    broadcast(payload, options = {}) {\n        // Lazy Set creation - skip allocation when not needed\n        const excludeArr = options.exclude;\n        const exclude = excludeArr?.length ? new Set(excludeArr) : null;\n        const includeArr = options.include;\n        const include = includeArr?.length ? new Set(includeArr) : null;\n\n        let delivered = 0;\n        const failed = [];\n\n        for (const [peerId, peer] of this.#peers) {\n            // Skip excluded peers\n            if (exclude?.has(peerId)) continue;\n\n            // Skip if not in include list (when specified)\n            if (include && !include.has(peerId)) continue;\n\n            // Skip disconnected peers\n            if (peer.status !== PeerStatus.CONNECTED) continue;\n\n            try {\n                const envelope = this.#createEnvelope(peerId, payload, MessageType.BROADCAST);\n                peer.sendFn(envelope);\n                delivered++;\n            } catch (error) {\n                console.error(`[Router] Failed to send to ${peerId}:`, error);\n                failed.push(peerId);\n            }\n        }\n\n        return { success: failed.length === 0, delivered, failed };\n    }\n\n    /**\n     * Gets the next sequence number for a peer.\n     * Used for causal ordering in SignalStore.\n     * \n     * @param {string} peerId\n     * @returns {number}\n     */\n    getSequence(peerId) {\n        return this.#peerSeq.get(peerId) ?? 0;\n    }\n\n    /**\n     * Updates peer status.\n     * \n     * @param {string} peerId\n     * @param {PeerStatus} status\n     */\n    setPeerStatus(peerId, status) {\n        const peer = this.#peerCache[peerId];\n        if (peer) {\n            peer.status = status;\n            this.emit('peer:status', { peerId, status });\n        }\n    }\n\n    /**\n     * Clears all peers.\n     */\n    clearPeers() {\n        // Fast iteration using cached array\n        const peerIds = this.#peerIds.slice();\n        for (const peerId of peerIds) {\n            this.removePeer(peerId);\n        }\n    }\n\n    // \n    // Private methods\n    // \n\n    /**\n     * Routes to a single peer.\n     * \n     */\n    #routeUnicast(peerId, payload) {\n        const peer = this.#peerCache[peerId];\n\n        if (!peer) {\n            return {\n                success: false,\n                delivered: 0,\n                failed: [peerId],\n                error: ErrorCode.PEER_NOT_FOUND\n            };\n        }\n\n        if (peer.status !== PeerStatus.CONNECTED) {\n            return {\n                success: false,\n                delivered: 0,\n                failed: [peerId],\n                error: ErrorCode.PEER_DISCONNECTED\n            };\n        }\n\n        try {\n            // If payload is already a protocol message (has the marker), send directly\n            // Otherwise wrap in envelope for signals/broadcasts\n            const messageToSend = (payload && payload._cb)\n                ? payload\n                : this.#createEnvelope(peerId, payload, MessageType.SIGNAL);\n            peer.sendFn(messageToSend);\n            return { success: true, delivered: 1, failed: [] };\n        } catch (error) {\n            console.error(`[Router] Failed to send to ${peerId}:`, error);\n            return { success: false, delivered: 0, failed: [peerId] };\n        }\n    }\n\n    /**\n     * Broadcasts to multiple peers.\n     * \n     */\n    #routeBroadcast(payload, exclude) {\n        // exclude is already a Set or null from route()\n        return this.broadcast(payload, exclude ? { exclude: Array.from(exclude) } : {});\n    }\n\n    /**\n     * Creates a message envelope with routing info.\n     * \n     */\n    #createEnvelope(peerId, payload, type) {\n        // Increment per-peer sequence\n        const seq = (this.#peerSeq.get(peerId) ?? 0) + 1;\n        this.#peerSeq.set(peerId, seq);\n\n        return {\n            id: `msg_${++this.#messageSeq}`,\n            t: type,\n            ts: Date.now(),\n            seq,\n            p: payload\n        };\n    }\n}\n","/**\n * @fileoverview Pending requests tracker for request/response pattern.\n * Tracks outgoing requests and matches them with responses.\n * @module router/pending-requests\n */\n\nimport { CrossBusError, ErrorCode } from '../common/errors.js';\nimport { deferred, withTimeout } from '../common/utils.js';\n\n/**\n * @typedef {Object} PendingRequest\n * @property {string} id - Request ID.\n * @property {string} targetPeer - Target peer ID.\n * @property {string} handlerName - Name of the handler.\n * @property {number} createdAt - When request was created.\n * @property {number} timeout - Timeout in ms.\n * @property {Function} resolve - Promise resolve function.\n * @property {Function} reject - Promise reject function.\n * @property {*} [defaultValue] - Value to return on timeout.\n */\n\n/**\n * @typedef {Object} RequestOptions\n * @property {number} [timeout=30000] - Request timeout in ms.\n * @property {*} [defaultValue] - Value to return on timeout instead of throwing.\n */\n\n/**\n * @typedef {Object} ResponseData\n * @property {string} requestId - Original request ID.\n * @property {boolean} success - Whether handler succeeded.\n * @property {*} [data] - Response data if successful.\n * @property {Object} [error] - Error if failed.\n */\n\n/**\n * Tracks pending requests and matches responses.\n * \n * Supports:\n * - Timeout handling\n * - Automatic cleanup\n * - Error propagation\n * - Request cancellation\n * \n * @example\n * const tracker = new PendingRequests();\n * \n * // Create request\n * const { requestId, promise } = tracker.create('peer-1', 'getData', {\n *   timeout: 5000\n * });\n * \n * // Send request via transport...\n * transport.send({ id: requestId, type: 'request', handler: 'getData' });\n * \n * // When response arrives:\n * tracker.resolve(requestId, responseData);\n * \n * // Or wait for response:\n * const result = await promise;\n */\nexport class PendingRequests {\n    /** @type {Map<string, PendingRequest>} Full feature storage */\n    #pending = new Map();\n\n    /** @type {Object<string, PendingRequest>} Fast Object-based cache for lookup */\n    #cache = Object.create(null);\n\n    /** @type {number} */\n    #requestCounter = 0;\n\n    /** @type {number} Default timeout */\n    #defaultTimeout;\n\n    /** @type {number} Maximum pending requests */\n    #maxPending;\n\n    /**\n     * Creates a new pending requests tracker.\n     * \n     * @param {Object} [options={}]\n     * @param {number} [options.defaultTimeout=30000] - Default timeout in ms.\n     * @param {number} [options.maxPending=1000] - Maximum pending requests (0 = unlimited).\n     */\n    constructor(options = {}) {\n        this.#defaultTimeout = options.defaultTimeout ?? 30000;\n        this.#maxPending = options.maxPending ?? 1000;\n    }\n\n    /**\n     * Creates a new pending request.\n     * \n     * @param {string} targetPeer - Target peer ID.\n     * @param {string} handlerName - Name of the handler to invoke.\n     * @param {RequestOptions} [options={}] - Request options.\n     * @returns {{ requestId: string, promise: Promise<*> }}\n     * \n     * @example\n     * const { requestId, promise } = tracker.create('widget', 'getState');\n     * const result = await promise;\n     */\n    create(targetPeer, handlerName, options = {}) {\n        // Enforce max pending limit to prevent memory exhaustion\n        if (this.#maxPending > 0 && this.#pending.size >= this.#maxPending) {\n            throw CrossBusError.from(ErrorCode.MAX_PENDING, {\n                current: this.#pending.size,\n                max: this.#maxPending,\n                targetPeer,\n                handlerName\n            });\n        }\n\n        const now = Date.now();\n        const requestId = `req_${++this.#requestCounter}_${now}`;\n        const timeout = options.timeout ?? this.#defaultTimeout;\n        const { promise, resolve, reject } = deferred();\n\n        /** @type {PendingRequest} */\n        const pending = {\n            id: requestId,\n            targetPeer,\n            handlerName,\n            createdAt: now,\n            timeout,\n            resolve,\n            reject,\n            defaultValue: options.defaultValue\n        };\n\n        this.#pending.set(requestId, pending);\n        this.#cache[requestId] = pending;  // Sync fast cache\n\n        // Set up timeout\n        const timeoutPromise = withTimeout(promise, timeout).catch(error => {\n            // Cleanup on timeout - use cache for fast check\n            if (requestId in this.#cache) {\n                this.#pending.delete(requestId);\n                delete this.#cache[requestId];\n\n                // Return default value if provided\n                if ('defaultValue' in options) {\n                    return options.defaultValue;\n                }\n\n                throw CrossBusError.from(ErrorCode.RESPONSE_TIMEOUT, {\n                    requestId,\n                    targetPeer,\n                    handlerName,\n                    timeout\n                });\n            }\n            throw error;\n        });\n\n        return { requestId, promise: timeoutPromise };\n    }\n\n    /**\n     * Resolves a pending request with response data.\n     * \n     * @param {string} requestId - Request ID to resolve.\n     * @param {ResponseData} response - Response data.\n     * @returns {boolean} True if request was found and resolved.\n     */\n    resolve(requestId, response) {\n        const pending = this.#cache[requestId];\n        if (!pending) return false;\n\n        // Sync both storages\n        this.#pending.delete(requestId);\n        delete this.#cache[requestId];\n\n        if (response.success) {\n            pending.resolve(response.data);\n        } else {\n            const error = CrossBusError.from(\n                response.error?.code ?? ErrorCode.HANDLER_ERROR,\n                {\n                    requestId,\n                    targetPeer: pending.targetPeer,\n                    handlerName: pending.handlerName,\n                    originalError: response.error\n                }\n            );\n            error.message = response.error?.message ?? 'Handler error';\n            pending.reject(error);\n        }\n\n        return true;\n    }\n\n    /**\n     * Rejects a pending request with an error.\n     * \n     * @param {string} requestId - Request ID to reject.\n     * @param {Error|string} error - Error or error message.\n     * @returns {boolean} True if request was found and rejected.\n     */\n    reject(requestId, error) {\n        const pending = this.#cache[requestId];\n        if (!pending) return false;\n\n        // Sync both storages\n        this.#pending.delete(requestId);\n        delete this.#cache[requestId];\n\n        const err = error instanceof Error ? error : new Error(error);\n        pending.reject(err);\n\n        return true;\n    }\n\n    /**\n     * Cancels a pending request.\n     * \n     * @param {string} requestId - Request ID to cancel.\n     * @returns {boolean} True if request was found and cancelled.\n     */\n    cancel(requestId) {\n        const pending = this.#cache[requestId];\n        if (!pending) return false;\n\n        // Sync both storages\n        this.#pending.delete(requestId);\n        delete this.#cache[requestId];\n        pending.reject(new Error('Request cancelled'));\n\n        return true;\n    }\n\n    /**\n     * Cancels all pending requests for a peer.\n     * Used when peer disconnects.\n     * \n     * @param {string} peerId - Peer ID.\n     * @returns {number} Number of requests cancelled.\n     */\n    cancelForPeer(peerId) {\n        let count = 0;\n\n        for (const [requestId, pending] of this.#pending) {\n            if (pending.targetPeer === peerId) {\n                this.#pending.delete(requestId);\n                delete this.#cache[requestId];  // Sync cache\n                pending.reject(CrossBusError.from(ErrorCode.PEER_DISCONNECTED, {\n                    peerId,\n                    requestId\n                }));\n                count++;\n            }\n        }\n\n        return count;\n    }\n\n    /**\n     * Cancels all pending requests.\n     * \n     * @returns {number} Number of requests cancelled.\n     */\n    cancelAll() {\n        const count = this.#pending.size;\n\n        for (const [requestId, pending] of this.#pending) {\n            pending.reject(new Error('All requests cancelled'));\n        }\n\n        this.#pending.clear();\n        // Reset cache to empty object\n        for (const key in this.#cache) {\n            delete this.#cache[key];\n        }\n        return count;\n    }\n\n    /**\n     * Checks if a request is pending.\n     * \n     * @param {string} requestId\n     * @returns {boolean}\n     */\n    has(requestId) {\n        // Fast Object-based check (faster than Map.has)\n        return requestId in this.#cache;\n    }\n\n    /**\n     * Gets a pending request.\n     * \n     * @param {string} requestId\n     * @returns {PendingRequest|undefined}\n     */\n    get(requestId) {\n        // Fast Object-based lookup\n        return this.#cache[requestId];\n    }\n\n    /**\n     * Gets count of pending requests.\n     * @returns {number}\n     */\n    get size() {\n        return this.#pending.size;\n    }\n\n    /**\n     * Gets all pending request IDs.\n     * @returns {string[]}\n     */\n    getRequestIds() {\n        return Array.from(this.#pending.keys());\n    }\n\n    /**\n     * Gets pending requests for a specific peer.\n     * \n     * @param {string} peerId\n     * @returns {PendingRequest[]}\n     */\n    getForPeer(peerId) {\n        const requests = [];\n        for (const pending of this.#pending.values()) {\n            if (pending.targetPeer === peerId) {\n                requests.push(pending);\n            }\n        }\n        return requests;\n    }\n}\n","/**\n * @fileoverview Secure handshake protocol for peer negotiation.\n * Handles connection establishment, authentication, and capability exchange.\n * @module security/handshake\n */\n\nimport { MessageType, HandshakePhase } from '../common/types.js';\nimport { ErrorCode } from '../common/errors.js';\nimport { uuid, deferred, withTimeout } from '../common/utils.js';\n\n/**\n * @typedef {Object} HandshakeConfig\n * @property {string} [peerId] - Our peer ID (auto-generated if not specified).\n * @property {number} [timeout=10000] - Handshake timeout in ms.\n * @property {Object} [meta={}] - Metadata to share with peer.\n * @property {string[]} [capabilities=[]] - Supported capabilities.\n */\n\n/**\n * @typedef {Object} PeerInfo\n * @property {string} peerId - Remote peer's ID.\n * @property {string} origin - Remote peer's origin.\n * @property {string} type - Remote peer's type (iframe, worker, etc).\n * @property {Object} meta - Remote peer's metadata.\n * @property {string[]} capabilities - Remote peer's capabilities.\n * @property {number} connectedAt - Connection timestamp.\n */\n\n/**\n * @typedef {Object} HandshakeResult\n * @property {boolean} success - Whether handshake succeeded.\n * @property {PeerInfo} [peer] - Peer info if successful.\n * @property {string} [error] - Error code if failed.\n * @property {string} [reason] - Error reason if failed.\n */\n\n/**\n * Handshake protocol for secure peer establishment.\n * \n * Protocol flow:\n * ```\n * INITIATOR                          RESPONDER\n *                                        \n *       HANDSHAKE_INIT                   \n *       { peerId, meta, caps }           \n *         \n *                                        \n *       HANDSHAKE_ACK                    \n *       { peerId, meta, caps, accept }   \n *         \n *                                        \n *       HANDSHAKE_COMPLETE               \n *       { confirmed: true }              \n *         \n *                                        \n *        Connected                      \n * ```\n */\nexport class Handshake {\n    /** @type {string} */\n    #localPeerId;\n\n    /** @type {Object} */\n    #meta;\n\n    /** @type {string[]} */\n    #capabilities;\n\n    /** @type {number} */\n    #timeout;\n\n    /** @type {Map<string, Object>} */\n    #pendingHandshakes = new Map();\n\n    /**\n     * Creates a new Handshake handler.\n     * \n     * @param {HandshakeConfig} [config={}]\n     */\n    constructor(config = {}) {\n        this.#localPeerId = config.peerId ?? uuid();\n        this.#meta = config.meta ?? {};\n        this.#capabilities = config.capabilities ?? [];\n        this.#timeout = config.timeout ?? 10000;\n    }\n\n    /**\n     * Gets the local peer ID.\n     * @returns {string}\n     */\n    get peerId() {\n        return this.#localPeerId;\n    }\n\n    /**\n     * Creates a handshake initiation message.\n     * \n     * @returns {Object} Handshake init message.\n     */\n    createInitMessage() {\n        return {\n            type: MessageType.HANDSHAKE_INIT,\n            handshakeId: uuid(),\n            peerId: this.#localPeerId,\n            meta: this.#meta,\n            capabilities: this.#capabilities,\n            timestamp: Date.now()\n        };\n    }\n\n    /**\n     * Creates a handshake acknowledgment message.\n     * \n     * @param {Object} initMessage - The received init message.\n     * @param {boolean} accept - Whether to accept the connection.\n     * @param {string} [reason] - Rejection reason if not accepted.\n     * @returns {Object} Handshake ack message.\n     */\n    createAckMessage(initMessage, accept, reason) {\n        return {\n            type: MessageType.HANDSHAKE_ACK,\n            handshakeId: initMessage.handshakeId,\n            peerId: this.#localPeerId,\n            meta: this.#meta,\n            capabilities: this.#capabilities,\n            accept,\n            reason: accept ? undefined : reason,\n            timestamp: Date.now()\n        };\n    }\n\n    /**\n     * Creates a handshake completion message.\n     * \n     * @param {string} handshakeId - The handshake ID.\n     * @returns {Object} Handshake complete message.\n     */\n    createCompleteMessage(handshakeId) {\n        return {\n            type: MessageType.HANDSHAKE_COMPLETE,\n            handshakeId,\n            confirmed: true,\n            timestamp: Date.now()\n        };\n    }\n\n    /**\n     * Initiates a handshake with a peer.\n     * \n     * @param {EventListener} sendFn - Function to send messages to peer.\n     * @returns {Promise<HandshakeResult>} Result of handshake attempt.\n     */\n    async initiate(sendFn) {\n        const initMsg = this.createInitMessage();\n        const { promise, resolve, reject } = deferred();\n\n        // Store pending handshake\n        this.#pendingHandshakes.set(initMsg.handshakeId, {\n            phase: HandshakePhase.INIT_SENT,\n            resolve,\n            reject,\n            initMsg,\n            startTime: Date.now()\n        });\n\n        // Send init message\n        sendFn(initMsg);\n\n        // Wait for response with timeout\n        try {\n            const result = await withTimeout(promise, this.#timeout);\n            return result;\n        } catch (/** @type {any} */ error) {\n            this.#pendingHandshakes.delete(initMsg.handshakeId);\n\n            if (error.code === ErrorCode.HANDSHAKE_TIMEOUT) {\n                return {\n                    success: false,\n                    error: ErrorCode.HANDSHAKE_TIMEOUT,\n                    reason: `Handshake timeout after ${this.#timeout}ms`\n                };\n            }\n\n            return {\n                success: false,\n                error: ErrorCode.HANDSHAKE_REJECTED,\n                reason: error.message\n            };\n        }\n    }\n\n    /**\n     * Handles a received handshake message.\n     * \n     * @param {Object} message - Received handshake message.\n     * @param {string} origin - Origin of the message.\n     * @param {EventListener} sendFn - Function to send response.\n     * @param {EventListener} [validateFn] - Optional validation function.\n     * @returns {PeerInfo|null} Peer info if handshake completes, null otherwise.\n     */\n    handleMessage(message, origin, sendFn, validateFn) {\n        switch (message.type) {\n            case MessageType.HANDSHAKE_INIT:\n                return this.#handleInit(message, origin, sendFn, validateFn);\n\n            case MessageType.HANDSHAKE_ACK:\n                return this.#handleAck(message, origin, sendFn);\n\n            case MessageType.HANDSHAKE_COMPLETE:\n                return this.#handleComplete(message, origin);\n\n            default:\n                return null;\n        }\n    }\n\n    /**\n     * Checks if a handshake is pending.\n     * \n     * @param {string} handshakeId\n     * @returns {boolean}\n     */\n    hasPending(handshakeId) {\n        return this.#pendingHandshakes.has(handshakeId);\n    }\n\n    /**\n     * Cancels a pending handshake.\n     * \n     * @param {string} handshakeId\n     */\n    cancel(handshakeId) {\n        const pending = this.#pendingHandshakes.get(handshakeId);\n        if (pending) {\n            pending.reject(new Error('Handshake cancelled'));\n            this.#pendingHandshakes.delete(handshakeId);\n        }\n    }\n\n    /**\n     * Cancels all pending handshakes.\n     */\n    cancelAll() {\n        for (const [id, pending] of this.#pendingHandshakes) {\n            pending.reject(new Error('All handshakes cancelled'));\n        }\n        this.#pendingHandshakes.clear();\n    }\n\n    // \n    // Private handlers\n    // \n\n    /**\n     * Handles HANDSHAKE_INIT message (we are responder).\n     * \n     */\n    #handleInit(message, origin, sendFn, validateFn) {\n        // Validate if validator provided\n        if (validateFn && !validateFn(message, origin)) {\n            const ack = this.createAckMessage(message, false, 'Validation failed');\n            sendFn(ack);\n            return null;\n        }\n\n        // Accept the connection\n        const ack = this.createAckMessage(message, true);\n        sendFn(ack);\n\n        // Store awaiting complete\n        this.#pendingHandshakes.set(message.handshakeId, {\n            phase: HandshakePhase.ACK_SENT,\n            remotePeer: {\n                peerId: message.peerId,\n                origin,\n                meta: message.meta,\n                capabilities: message.capabilities\n            }\n        });\n\n        return null; // Wait for complete message\n    }\n\n    /**\n     * Handles HANDSHAKE_ACK message (we are initiator).\n     * \n     */\n    #handleAck(message, origin, sendFn) {\n        const pending = this.#pendingHandshakes.get(message.handshakeId);\n        if (!pending) {\n            return null; // Unknown handshake\n        }\n\n        if (!message.accept) {\n            // Rejected\n            pending.reject(new Error(message.reason || 'Connection rejected'));\n            this.#pendingHandshakes.delete(message.handshakeId);\n            return null;\n        }\n\n        // Send complete message\n        const complete = this.createCompleteMessage(message.handshakeId);\n        sendFn(complete);\n\n        // Create peer info\n        const peerInfo = {\n            peerId: message.peerId,\n            origin,\n            meta: message.meta,\n            capabilities: message.capabilities,\n            type: 'unknown', // Will be updated by PeerRegistry\n            connectedAt: Date.now()\n        };\n\n        // Resolve the promise\n        pending.resolve({\n            success: true,\n            peer: peerInfo\n        });\n\n        this.#pendingHandshakes.delete(message.handshakeId);\n        return peerInfo;\n    }\n\n    /**\n     * Handles HANDSHAKE_COMPLETE message (we are responder).\n     * \n     */\n    #handleComplete(message, origin) {\n        const pending = this.#pendingHandshakes.get(message.handshakeId);\n        if (!pending || pending.phase !== HandshakePhase.ACK_SENT) {\n            return null;\n        }\n\n        if (!message.confirmed) {\n            this.#pendingHandshakes.delete(message.handshakeId);\n            return null;\n        }\n\n        // Handshake complete!\n        const peerInfo = {\n            ...pending.remotePeer,\n            connectedAt: Date.now()\n        };\n\n        this.#pendingHandshakes.delete(message.handshakeId);\n        return peerInfo;\n    }\n}\n","/**\n * @fileoverview Origin validation for cross-origin security.\n * Validates message origins against an allowlist.\n * @module security/origin-validator\n */\n\n/**\n * @typedef {Object} OriginValidatorOptions\n * @property {string[]} [allowed=[]] - Allowed origins. Empty = same-origin only.\n * @property {boolean} [allowAll=false] - Allow all origins (dangerous!).\n */\n\n/**\n * Validates message origins against a configured allowlist.\n * \n * Supports:\n * - Exact matches: 'https://example.com'\n * - Wildcards: 'https://*.example.com' (subdomains only)\n * - Protocols: 'chrome-extension://*', 'file://*'\n * \n * @example\n * const validator = new OriginValidator({\n *   allowed: [\n *     'https://app.example.com',\n *     'https://*.widgets.com'\n *   ]\n * });\n * \n * validator.isAllowed('https://app.example.com');     // true\n * validator.isAllowed('https://foo.widgets.com');     // true\n * validator.isAllowed('https://evil.com');            // false\n */\nexport class OriginValidator {\n    /** @type {Set<string>} */\n    #exactOrigins = new Set();\n\n    /** @type {RegExp[]} */\n    #patterns = [];\n\n    /** @type {boolean} */\n    #allowAll = false;\n\n    /** @type {string|undefined} */\n    #selfOrigin;\n\n    /**\n     * Creates a new origin validator.\n     * \n     * @param {OriginValidatorOptions} [options={}] - Configuration.\n     */\n    constructor(options = {}) {\n        this.#allowAll = options.allowAll ?? false;\n        this.#selfOrigin = globalThis.location?.origin;\n\n        // Process allowed origins\n        if (options.allowed) {\n            for (const origin of options.allowed) {\n                this.#addOrigin(origin);\n            }\n        }\n    }\n\n    /**\n     * Checks if an origin is allowed.\n     * \n     * @param {string} origin - Origin to check (e.g., 'https://example.com').\n     * @returns {boolean} True if allowed.\n     * \n     * @example\n     * validator.isAllowed('https://trusted.com');  // true\n     * validator.isAllowed('https://unknown.com');  // false\n     */\n    isAllowed(origin) {\n        // Allow-all mode (dangerous but sometimes needed)\n        if (this.#allowAll) {\n            return true;\n        }\n\n        // Null origin (file://, sandboxed iframes, etc.)\n        if (origin === 'null' || origin === null) {\n            return this.#exactOrigins.has('null');\n        }\n\n        // Empty/no allowed origins = same-origin only\n        if (this.#exactOrigins.size === 0 && this.#patterns.length === 0) {\n            return origin === this.#selfOrigin;\n        }\n\n        // Check exact match first (fast path)\n        if (this.#exactOrigins.has(origin)) {\n            return true;\n        }\n\n        // Check pattern matches\n        for (const pattern of this.#patterns) {\n            if (pattern.test(origin)) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    /**\n     * Adds an origin to the allowlist.\n     * \n     * @param {string} origin - Origin to add (supports wildcards).\n     * @returns {this} For chaining.\n     */\n    allow(origin) {\n        this.#addOrigin(origin);\n        return this;\n    }\n\n    /**\n     * Removes an origin from the allowlist.\n     * \n     * @param {string} origin - Origin to remove.\n     * @returns {boolean} True if removed.\n     */\n    disallow(origin) {\n        // For exact origins\n        if (this.#exactOrigins.has(origin)) {\n            this.#exactOrigins.delete(origin);\n            return true;\n        }\n\n        // For patterns, we'd need to store the original string\n        // For simplicity, patterns cannot be removed individually\n        return false;\n    }\n\n    /**\n     * Gets all exact (non-pattern) allowed origins.\n     * \n     * @returns {string[]} Array of allowed origins.\n     */\n    getAllowed() {\n        return Array.from(this.#exactOrigins);\n    }\n\n    /**\n     * Clears all allowed origins.\n     */\n    clear() {\n        this.#exactOrigins.clear();\n        this.#patterns = [];\n    }\n\n    /**\n     * Gets the current origin (if available).\n     * @returns {string|undefined}\n     */\n    get selfOrigin() {\n        return this.#selfOrigin;\n    }\n\n    // \n    // Private methods\n    // \n\n    /**\n     * Adds an origin to the appropriate collection.\n     * \n     * @param {string} origin\n     */\n    #addOrigin(origin) {\n        if (typeof origin !== 'string') {\n            throw new TypeError('Origin must be a string');\n        }\n\n        // Wildcard '*' means allow all\n        if (origin === '*') {\n            this.#allowAll = true;\n            return;\n        }\n\n        // Contains wildcards - create pattern\n        if (origin.includes('*')) {\n            const pattern = this.#createPattern(origin);\n            this.#patterns.push(pattern);\n        } else {\n            // Exact origin\n            this.#exactOrigins.add(origin);\n        }\n    }\n\n    /**\n     * Creates a RegExp from a wildcard pattern.\n     * Uses bounded quantifiers to prevent ReDoS attacks.\n     * \n     * @param {string} pattern - Pattern with wildcards.\n     * @returns {RegExp}\n     */\n    #createPattern(pattern) {\n        // Escape special regex characters except *\n        const escaped = pattern\n            .replace(/[.+?^${}()|[\\]\\\\]/g, '\\\\$&')\n            // Use bounded quantifier to prevent catastrophic backtracking\n            // Allows up to 253 chars per segment (max DNS label)\n            .replace(/\\*/g, '[a-zA-Z0-9.-]{0,253}');\n\n        return new RegExp(`^${escaped}$`);\n    }\n}\n\n/**\n * Creates an origin validator with common configurations.\n */\nexport const OriginValidatorPresets = {\n    /**\n     * Same-origin only (most secure).\n     * @returns {OriginValidator}\n     */\n    sameOrigin() {\n        return new OriginValidator();\n    },\n\n    /**\n     * Allow all origins (use with caution!).\n     * @returns {OriginValidator}\n     */\n    allowAll() {\n        return new OriginValidator({ allowAll: true });\n    },\n\n    /**\n     * Allow specific domains.\n     * @param {string[]} origins\n     * @returns {OriginValidator}\n     */\n    fromList(origins) {\n        return new OriginValidator({ allowed: origins });\n    }\n};\n","/**\n * @fileoverview CrossBus - Main facade for cross-context messaging.\n * Provides a unified API for inter-context communication.\n * @module core/cross-bus\n */\n\nimport { EventEmitter } from './event-emitter.js';\nimport { MessageType, PeerStatus } from '../common/types.js';\nimport { createSignalMessage, createRequestMessage, createResponseMessage } from './message-types.js';\nimport { CrossBusError, ErrorCode } from '../common/errors.js';\nimport { uuid } from '../common/utils.js';\nimport { MessageRouter } from '../router/message-router.js';\nimport { PendingRequests } from '../router/pending-requests.js';\nimport { Handshake } from '../security/handshake.js';\nimport { OriginValidator } from '../security/origin-validator.js';\n\n/**\n * @typedef {Object} CrossBusOptions\n * @property {string} [peerId] - Unique peer identifier (auto-generated if not specified).\n * @property {boolean} [isHub=false] - Whether this instance is the hub.\n * @property {number} [requestTimeout=30000] - Default request timeout in ms.\n * @property {number} [handshakeTimeout=10000] - Handshake timeout in ms.\n * @property {string[]} [allowedOrigins=[]] - Allowed origins for incoming connections.\n * @property {Object} [meta={}] - Metadata to share with peers.\n * @property {string[]} [capabilities=[]] - Supported capabilities.\n * @property {string} [contentType='application/json'] - Preferred serialization format.\n * @property {number} [maxPayloadSize=1048576] - Maximum payload size in bytes (default: 1MB).\n * @property {number} [maxPendingRequests=100] - Maximum concurrent pending requests.\n * @property {boolean} [strictMode=false] - Enforce strict security (disallows wildcard origins).\n * @property {boolean} [debug=false] - Enable verbose debug logging.\n * @property {string} [debugPrefix='[CrossBus]'] - Prefix for debug log messages.\n */\n\n/**\n * @typedef {Object} HandlerOptions\n * @property {string[]} [allowedPeers] - Peer IDs allowed to call this handler.\n * @property {number} [rateLimit] - Max calls per second from each peer.\n * @property {Function} [validatePayload] - Custom payload validator function.\n */\n\n/**\n * @typedef {Object} PeerInfo\n * @property {string} peerId - Peer identifier.\n * @property {string} origin - Peer origin.\n * @property {Object} meta - Peer metadata.\n * @property {PeerStatus} status - Connection status.\n * @property {number} connectedAt - Connection timestamp.\n */\n\n/**\n * @typedef {Object} RequestOptions\n * @property {number} [timeout] - Request timeout in ms.\n * @property {*} [defaultValue] - Value to return on timeout instead of throwing.\n */\n\n/**\n * @typedef {Object} BroadcastRequestOptions\n * @property {number} [timeout] - Per-peer timeout in ms.\n * @property {string[]} [exclude] - Peer IDs to exclude.\n * @property {boolean} [ignoreErrors=true] - Whether to ignore peer errors.\n */\n\n/**\n * @typedef {Object} HookContext\n * @property {'signal'|'request'|'response'} type - Message type.\n * @property {string} [peerId] - Peer ID (if applicable).\n * @property {string} [handlerName] - Handler name (for requests).\n * @property {'inbound'|'outbound'} direction - Hook direction.\n */\n\n/**\n * @callback MessageHook\n * @param {*} payload - Payload to transform.\n * @param {HookContext} context - Hook context.\n * @returns {*|Promise<*>} Transformed payload.\n */\n\n/**\n * @typedef {Object} HookEntry\n * @property {MessageHook} fn - Hook function.\n * @property {number} priority - Execution priority (lower = first).\n */\n\n/**\n * @callback RequestHandler\n * @param {*} payload - Request payload.\n * @param {Object} context - Request context (peerId, meta, etc).\n * @returns {Promise<*>|*} - Response data.\n */\n\n/**\n * CrossBus - Zero-leak, high-performance cross-context messaging.\n * \n * Features:\n * - Hub/Mesh routing\n * - Request/Response pattern\n * - Broadcast to all peers\n * - ACK-based reliability\n * - Origin validation\n * - Resource lifecycle management\n * \n * @example\n * // Hub (main page)\n * const hub = new CrossBus({ isHub: true });\n * \n * // Connect iframe\n * hub.connect(iframe.contentWindow, {\n *   targetOrigin: 'https://widget.example.com'\n * });\n * \n * // Register handler\n * hub.handle('getData', async (payload, ctx) => {\n *   return { items: await fetchItems() };\n * });\n * \n * // Emit signal\n * hub.emit('user:login', { userId: 123 });\n * \n * // Request/Response\n * const result = await hub.request('widget-1', 'getStatus');\n * \n * // Cleanup\n * hub.destroy();\n */\nexport class CrossBus extends EventEmitter {\n    /** @type {string} */\n    #peerId;\n\n    /** @type {boolean} */\n    #isHub;\n\n    /** @type {MessageRouter} */\n    #router;\n\n    /** @type {PendingRequests} */\n    #pendingRequests;\n\n    /** @type {Handshake} */\n    #handshake;\n\n    /** @type {OriginValidator} */\n    #originValidator;\n\n    /** @type {string} */\n    #contentType;\n\n    /** @type {Map<string, RequestHandler>} */\n    #handlers = new Map();\n\n    /** @type {HookEntry[]} */\n    #inboundHooks = [];\n\n    /** @type {HookEntry[]} */\n    #outboundHooks = [];\n\n    /** @type {Object} */\n    #meta;\n\n    /** @type {string[]} */\n    #capabilities;\n\n    /** @type {number} */\n    #requestTimeout;\n\n    /** @type {number} */\n    #maxPayloadSize;\n\n    /** @type {number} */\n    #maxPendingRequests;\n\n    /** @type {boolean} */\n    #strictMode;\n\n    /** @type {Map<string, { count: number, resetAt: number }>} */\n    #rateLimitCounters = new Map();\n\n    /** @type {Map<string, HandlerOptions>} */\n    #handlerOptions = new Map();\n\n    /** @type {boolean} */\n    #debug = false;\n\n    /** @type {string} */\n    #debugPrefix = '[CrossBus]';\n\n    /** @type {number} */\n    #createdAt;\n\n    /** @type {boolean} */\n    #destroyed = false;\n\n    /**\n     * Creates a new CrossBus instance.\n     * \n     * @param {CrossBusOptions} [options={}]\n     */\n    constructor(options = {}) {\n        super();\n\n        this.#peerId = options.peerId ?? uuid();\n        this.#isHub = options.isHub ?? false;\n        this.#meta = options.meta ?? {};\n        this.#capabilities = options.capabilities ?? [];\n        this.#requestTimeout = options.requestTimeout ?? 30000;\n\n        // Initialize components\n        this.#router = new MessageRouter();\n        this.#pendingRequests = new PendingRequests({\n            defaultTimeout: this.#requestTimeout\n        });\n        this.#handshake = new Handshake({\n            peerId: this.#peerId,\n            meta: this.#meta,\n            capabilities: this.#capabilities,\n            timeout: options.handshakeTimeout ?? 10000\n        });\n        this.#originValidator = new OriginValidator({\n            allowed: options.allowedOrigins ?? []\n        });\n\n        // Serialization setup\n        this.#contentType = options.contentType ?? 'application/json';\n        // this.#serializer = getSerializer(this.#contentType);\n\n        // Security settings\n        this.#maxPayloadSize = options.maxPayloadSize ?? 1024 * 1024; // 1MB\n        this.#maxPendingRequests = options.maxPendingRequests ?? 100;\n        this.#strictMode = options.strictMode ?? false;\n\n        // Debug settings\n        this.#debug = options.debug ?? false;\n        this.#debugPrefix = options.debugPrefix ?? '[CrossBus]';\n        this.#createdAt = Date.now();\n\n        // Development security warnings\n        this.#emitSecurityWarnings(options);\n\n        // Initialize handshake capability\n        this.#capabilities.push(`serializer:${this.#contentType}`);\n\n        // Wire up router events\n        this.#router.on('peer:added', (e) => { this.emit('peer:connected', e.data); });\n        this.#router.on('peer:removed', (e) => { this.emit('peer:disconnected', e.data); });\n        this.#router.on('peer:status', (e) => { this.emit('peer:status', e.data); });\n\n        if (this.#debug) {\n            this.#log('info', `Initialized (isHub: ${this.#isHub})`);\n        }\n    }\n\n    /**\n     * Gets the local peer ID.\n     * @returns {string}\n     */\n    get peerId() {\n        return this.#peerId;\n    }\n\n    /**\n     * Gets whether this instance is the hub.\n     * @returns {boolean}\n     */\n    get isHub() {\n        return this.#isHub;\n    }\n\n    /**\n     * Gets connected peer count.\n     * @returns {number}\n     */\n    get peerCount() {\n        return this.#router.peerCount;\n    }\n\n    /**\n     * Gets all connected peer IDs.\n     * @returns {string[]}\n     */\n    get peers() {\n        return this.#router.getPeerIds();\n    }\n\n    /**\n     * Gets peer info by ID.\n     * \n     * @param {string} peerId\n     * @returns {PeerInfo|undefined}\n     */\n    getPeer(peerId) {\n        return this.#router.getPeer(peerId);\n    }\n\n    // \n    // Messaging API\n    // \n\n    /**\n     * Sends a signal to all connected peers.\n     * \n     * @param {string} signalName - Signal name (e.g., 'user:login').\n     * @param {*} [payload] - Signal payload.\n     * @param {Object} [options={}] - Send options.\n     * @param {string[]} [options.exclude] - Peer IDs to exclude.\n     * @returns {Promise<{ delivered: number, failed: string[] }>}\n     *  \n     * @example\n     * bus.signal('user:login', { userId: 123 });\n     */\n    async signal(signalName, payload, options = {}) {\n        this.#assertNotDestroyed();\n\n        // Apply outbound hooks\n        const transformedPayload = await this.#runHooks(\n            this.#outboundHooks,\n            payload,\n            { type: 'signal', direction: 'outbound' }\n        );\n\n        const message = createSignalMessage(\n            signalName,\n            transformedPayload,\n            this.#peerId\n        );\n\n        const result = await this.#router.broadcast(message, options);\n\n        this.#log('out', `SIGNAL \"${signalName}\" to ${result.delivered} peers`);\n\n        return result;\n    }\n\n    /**\n     * Sends a request to a specific peer and waits for response.\n     * \n     * @param {string} peerId - Target peer ID.\n     * @param {string} handlerName - Handler to invoke.\n     * @param {*} [payload] - Request payload.\n     * @param {RequestOptions} [options={}]\n     * @returns {Promise<*>} Handler response.\n     * \n     * @example\n     * const data = await bus.request('widget-1', 'getData', { id: 5 });\n     */\n    async request(peerId, handlerName, payload, options = {}) {\n        this.#assertNotDestroyed();\n\n        this.#log('out', `REQUEST \"${handlerName}\" to ${peerId}`);\n\n        const peer = this.#router.getPeer(peerId);\n        if (!peer) {\n            throw CrossBusError.from(ErrorCode.PEER_NOT_FOUND, { peerId });\n        }\n\n        // Create pending request\n        const { requestId, promise } = this.#pendingRequests.create(\n            peerId,\n            handlerName,\n            { timeout: options.timeout ?? this.#requestTimeout }\n        );\n\n        // Apply outbound hooks\n        const transformedPayload = await this.#runHooks(\n            this.#outboundHooks,\n            payload,\n            { type: 'request', peerId, handlerName, direction: 'outbound' }\n        );\n\n        // Build request message\n        const message = createRequestMessage(\n            handlerName,\n            transformedPayload,\n            this.#peerId,\n            peerId,\n            requestId // Pass the tracking ID\n        );\n\n        // Send request\n        const result = this.#router.route({ target: peerId, payload: message });\n\n        if (!result.success) {\n            this.#pendingRequests.cancel(requestId);\n            throw CrossBusError.from(ErrorCode.SEND_FAILED, { peerId });\n        }\n\n        return promise;\n    }\n\n    /**\n     * Broadcasts a request to all peers and collects responses.\n     * \n     * @param {string} handlerName - Handler to invoke on all peers.\n     * @param {*} [payload] - Request payload.\n     * @param {BroadcastRequestOptions} [options={}]\n     * @returns {Promise<Map<string, *>>} Map of peerId -> response.\n     * \n     * @example\n     * const responses = await bus.broadcastRequest('getStatus');\n     * for (const [peerId, status] of responses) {\n     *   console.log(`${peerId}: ${status.state}`);\n     * }\n     */\n    async broadcastRequest(handlerName, payload, options = {}) {\n        this.#assertNotDestroyed();\n\n        const timeout = options.timeout ?? this.#requestTimeout;\n        const ignoreErrors = options.ignoreErrors ?? true;\n        const exclude = new Set(options.exclude ?? []);\n\n        const results = new Map();\n        const promises = [];\n\n        for (const peerId of this.#router.getPeerIds()) {\n            if (exclude.has(peerId)) continue;\n\n            const requestPromise = this.request(peerId, handlerName, payload, { timeout })\n                .then(response => {\n                    results.set(peerId, { success: true, data: response });\n                })\n                .catch(error => {\n                    if (ignoreErrors) {\n                        results.set(peerId, { success: false, error: error.message });\n                    } else {\n                        throw error;\n                    }\n                });\n\n            promises.push(requestPromise);\n        }\n\n        await Promise.all(promises);\n        return results;\n    }\n\n    // \n    // Handler API\n    // \n\n    /**\n     * Registers a request handler.\n     * \n     * @param {string} handlerName - Handler name.\n     * @param {RequestHandler} handler - Handler function.\n     * @param {HandlerOptions} [options={}] - Security options.\n     * @returns {Function} Unregister function.\n     * \n     * @example\n     * // Basic handler\n     * const unhandle = bus.handle('getData', async (payload, ctx) => {\n     *   return await fetchData(payload.id);\n     * });\n     * \n     * // Secure handler with restrictions\n     * bus.handle('sensitiveData', async (payload) => { ... }, {\n     *   allowedPeers: ['trusted-agent'],  // Only these peers can call\n     *   rateLimit: 10,                    // Max 10 calls/second per peer\n     *   validatePayload: (p) => p.id != null  // Custom validation\n     * });\n     */\n    handle(handlerName, handler, options = {}) {\n        if (this.#handlers.has(handlerName)) {\n            throw CrossBusError.from(ErrorCode.HANDLER_EXISTS, { handlerName });\n        }\n\n        // Store handler options for security checks\n        if (options.allowedPeers || options.rateLimit || options.validatePayload) {\n            this.#handlerOptions.set(handlerName, options);\n        }\n\n        this.#handlers.set(handlerName, handler);\n\n        return () => {\n            this.#handlers.delete(handlerName);\n            this.#handlerOptions.delete(handlerName);\n        };\n    }\n\n    /**\n     * Removes a handler.\n     * \n     * @param {string} handlerName\n     * @returns {boolean} True if handler was removed.\n     */\n    unhandle(handlerName) {\n        return this.#handlers.delete(handlerName);\n    }\n\n    /**\n     * Checks if a handler is registered.\n     * \n     * @param {string} handlerName\n     * @returns {boolean}\n     */\n    hasHandler(handlerName) {\n        return this.#handlers.has(handlerName);\n    }\n\n    // \n    // Hook API\n    // \n\n    /**\n     * Adds an inbound hook to transform incoming payloads.\n     * \n     * @param {MessageHook} hookFn - Hook function.\n     * @param {number} [priority=10] - Execution priority (lower = first).\n     * @returns {Function} Unregister function.\n     * \n     * @example\n     * // Decrypt incoming messages\n     * const unhook = bus.addInboundHook(async (payload, ctx) => {\n     *   return await decrypt(payload);\n     * });\n     */\n    addInboundHook(hookFn, priority = 10) {\n        if (typeof hookFn !== 'function') {\n            throw new TypeError('hookFn must be a function');\n        }\n\n        const entry = { fn: hookFn, priority };\n        this.#inboundHooks.push(entry);\n        this.#inboundHooks.sort((a, b) => a.priority - b.priority);\n\n        return () => this.removeInboundHook(hookFn);\n    }\n\n    /**\n     * Adds an outbound hook to transform outgoing payloads.\n     * \n     * @param {MessageHook} hookFn - Hook function.\n     * @param {number} [priority=10] - Execution priority (lower = first).\n     * @returns {Function} Unregister function.\n     * \n     * @example\n     * // Encrypt outgoing messages\n     * const unhook = bus.addOutboundHook(async (payload, ctx) => {\n     *   return await encrypt(payload);\n     * });\n     */\n    addOutboundHook(hookFn, priority = 10) {\n        if (typeof hookFn !== 'function') {\n            throw new TypeError('hookFn must be a function');\n        }\n\n        const entry = { fn: hookFn, priority };\n        this.#outboundHooks.push(entry);\n        this.#outboundHooks.sort((a, b) => a.priority - b.priority);\n\n        return () => this.removeOutboundHook(hookFn);\n    }\n\n    /**\n     * Removes an inbound hook.\n     * \n     * @param {MessageHook} hookFn\n     * @returns {boolean} True if removed.\n     */\n    removeInboundHook(hookFn) {\n        const index = this.#inboundHooks.findIndex(e => e.fn === hookFn);\n        if (index !== -1) {\n            this.#inboundHooks.splice(index, 1);\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Removes an outbound hook.\n     * \n     * @param {MessageHook} hookFn\n     * @returns {boolean} True if removed.\n     */\n    removeOutboundHook(hookFn) {\n        const index = this.#outboundHooks.findIndex(e => e.fn === hookFn);\n        if (index !== -1) {\n            this.#outboundHooks.splice(index, 1);\n            return true;\n        }\n        return false;\n    }\n\n    // \n    // Connection API\n    // \n\n    /**\n     * Adds a peer with a send function.\n     * Used for hub mode when managing connections manually.\n     * \n     * @param {string} peerId - Peer identifier.\n     * @param {EventListener} sendFn - Function to send messages.\n     * @param {Object} [options={}] - Additional options.\n     */\n    addPeer(peerId, sendFn, options = {}) {\n        this.#assertNotDestroyed();\n        this.#router.addPeer(peerId, sendFn, options);\n    }\n\n    /**\n     * Removes a peer.\n     * \n     * @param {string} peerId\n     * @returns {boolean}\n     */\n    removePeer(peerId) {\n        this.#pendingRequests.cancelForPeer(peerId);\n        return this.#router.removePeer(peerId);\n    }\n\n    /**\n     * Adds a transport and automatically wires up message handling.\n     * This is the recommended way to connect transports for AI agents.\n     * \n     * @param {Object} transport - Transport instance with send() and onMessage() methods.\n     * @param {Object} [options={}] - Additional options.\n     * @param {string} [options.peerId] - Override peer ID (defaults to transport's peerId or auto-generated).\n     * @param {string} [options.origin='*'] - Origin for message validation.\n     * @returns {Function} Cleanup function to remove the transport.\n     * \n     * @example\n     * // Simple usage\n     * const cleanup = bus.addTransport(new PostMessageTransport(iframe.contentWindow));\n     * \n     * // With options\n     * const cleanup = bus.addTransport(transport, { peerId: 'my-agent' });\n     * \n     * // Cleanup when done\n     * cleanup();\n     */\n    addTransport(transport, options = {}) {\n        this.#assertNotDestroyed();\n\n        if (!transport || typeof transport.send !== 'function') {\n            throw new TypeError('Transport must have a send() method');\n        }\n\n        const peerId = options.peerId || transport.peerId || `transport-${uuid()}`;\n        const origin = options.origin || '*';\n\n        // Wire up inbound: transport -> CrossBus\n        if (typeof transport.onMessage === 'function') {\n            transport.onMessage((message) => {\n                this.handleMessage(message, origin, peerId);\n            });\n        }\n\n        // Wire up outbound: CrossBus -> transport\n        this.addPeer(peerId, (message) => {\n            transport.send(message);\n        }, options);\n\n        // Return cleanup function\n        return () => {\n            this.removePeer(peerId);\n            if (typeof transport.destroy === 'function') {\n                transport.destroy();\n            }\n        };\n    }\n\n    /**\n     * Handles an incoming message.\n     * Call this when receiving a message from any transport.\n     * \n     * @param {Object} message - The received message.\n     * @param {string} origin - Origin of the message.\n     * @param {string} [peerId] - Source peer ID if known.\n     * @param {Function} [replyFn] - Function to reply to the sender.\n     */\n    async handleMessage(message, origin, peerId, replyFn) {\n        if (this.#destroyed) return;\n\n        // Validate origin\n        if (!this.#originValidator.isAllowed(origin)) {\n            console.warn(`[CrossBus] Blocked message from unauthorized origin: ${origin}`);\n            return;\n        }\n\n        // Apply inbound hooks to payload\n        // Apply inbound hooks to payload\n        // Support both standard 'payload'/'data' and legacy 'p'\n        const rawPayload = message.payload ?? message.data ?? message.p;\n        const msgType = message.type ?? message.t;\n\n        // Normalize fields based on schema\n        let handlerOrName = message.handler ?? message.name;\n        let dataContent = rawPayload;\n\n        // If ProtocolMessage (has 'payload' object containing metadata), extract from it\n        if (message.payload && typeof message.payload === 'object' && !message.p) {\n            if (msgType === MessageType.SIGNAL || msgType === MessageType.BROADCAST) {\n                handlerOrName = message.payload.name;\n                dataContent = message.payload.data;\n            } else if (msgType === MessageType.REQUEST) {\n                handlerOrName = message.payload.name;\n                dataContent = message.payload.data;\n            } else if (msgType === MessageType.RESPONSE) {\n                // Response payload structure? createResponseMessage puts 'data' in payload\n                dataContent = message.payload.data;\n            }\n        }\n        // Handle envelope format: { t, p: { type, payload: { name, data } } }\n        // Router creates envelopes with 'p' containing the original signal message\n        // Detect by: has 't' (not 'type'), has 'p' with nested 'payload' (ProtocolMessage structure)\n        else if (message.t && !message.type && message.p && typeof message.p === 'object' && message.p.payload) {\n            const innerMsg = message.p;\n            // Extract from nested ProtocolMessage\n            handlerOrName = innerMsg.payload.name ?? innerMsg.name;\n            dataContent = innerMsg.payload.data ?? innerMsg.data;\n        }\n\n        if (dataContent !== undefined) {\n            const hookContext = {\n                type: msgType === MessageType.SIGNAL ? 'signal' :\n                    msgType === MessageType.REQUEST ? 'request' : 'response',\n                peerId,\n                handlerName: handlerOrName,\n                direction: 'inbound'\n            };\n            // Run hooks\n            dataContent = await this.#runHooks(this.#inboundHooks, dataContent, hookContext);\n        }\n\n        switch (msgType) {\n            case MessageType.BROADCAST:  // Broadcast has same structure as signal\n            case MessageType.SIGNAL:\n                if (typeof handlerOrName !== 'string') {\n                    console.warn('[CrossBus] Invalid signal name type');\n                    return;\n                }\n                await this.#handleSignal(handlerOrName, dataContent, peerId);\n                break;\n\n            case MessageType.REQUEST:\n                if (typeof handlerOrName !== 'string') {\n                    console.warn('[CrossBus] Invalid handler name type');\n                    return;\n                }\n                // Pass normalized ID\n                // const reqId = message.id ?? (message.payload ? message.payload.id : undefined);\n                // Wait, 'id' is top level in ProtocolMessage AND legacy.\n\n                await this.#handleRequest(message.id, handlerOrName, dataContent, peerId, replyFn);\n                break;\n\n            case MessageType.RESPONSE: {\n                let success = message.success;\n                let error = message.error;\n\n                // Extract from ProtocolMessage payload if needed\n                if (message.payload && message.payload.success !== undefined) {\n                    success = message.payload.success;\n                    error = message.payload.error;\n                }\n\n                // If legacy response structure inside payload?\n                this.#handleResponse(message.payload?.requestId ?? message.id, success, dataContent, error);\n                break;\n            }\n\n            case MessageType.HANDSHAKE_INIT:\n            case MessageType.HANDSHAKE_ACK:\n            case MessageType.HANDSHAKE_COMPLETE:\n                this.#handshake.handleMessage(message, origin, /** @type {EventListener} */(replyFn));\n                break;\n\n            default:\n                console.warn(`[CrossBus] Unknown message type: ${msgType}`);\n        }\n    }\n\n    // \n    // Lifecycle\n    // \n\n    /**\n     * Destroys the CrossBus, cleaning up all resources.\n     */\n    destroy() {\n        if (this.#destroyed) return;\n\n        this.#destroyed = true;\n\n        // Cancel all pending requests\n        this.#pendingRequests.cancelAll();\n\n        // Clear handlers\n        this.#handlers.clear();\n\n        // Clear peers\n        this.#router.clearPeers();\n\n        // Clear event listeners\n        this.clear();\n\n        this.emit('destroyed', {});\n    }\n\n    /**\n     * Checks if the bus has been destroyed.\n     * @returns {boolean}\n     */\n    get isDestroyed() {\n        return this.#destroyed;\n    }\n\n    // \n    // Private handlers\n    // \n\n    /**\n     * Handles incoming signal.\n     * \n     */\n    async #handleSignal(name, data, peerId) {\n        await this.emit(name, {\n            payload: data,\n            source: peerId\n        });\n    }\n\n    /**\n     * Handles incoming request.\n     * \n     */\n    async #handleRequest(requestId, handlerName, data, peerId, replyFn) {\n        const handler = this.#handlers.get(handlerName);\n\n        let response;\n\n        if (!handler) {\n            response = createResponseMessage(\n                requestId,\n                null,\n                this.#peerId,\n                false,\n                {\n                    code: ErrorCode.NO_HANDLER,\n                    message: 'Handler not found'\n                }\n            );\n        } else {\n            // Check handler security (allowedPeers, rateLimit, validatePayload)\n            const securityCheck = this.#checkHandlerSecurity(handlerName, peerId, data);\n            if (!securityCheck.allowed) {\n                response = createResponseMessage(\n                    requestId,\n                    null,\n                    this.#peerId,\n                    false,\n                    {\n                        code: securityCheck.error?.code ?? ErrorCode.UNAUTHORIZED,\n                        message: securityCheck.error?.message ?? 'Security check failed'\n                    }\n                );\n            } else {\n                try {\n                    const result = await handler(data, {\n                        peerId,\n                        requestId: requestId,\n                        handlerName: handlerName\n                    });\n\n                    // Apply outbound hooks to response\n                    const transformedResult = await this.#runHooks(\n                        this.#outboundHooks,\n                        result,\n                        { type: 'response', peerId, handlerName: handlerName, direction: 'outbound' }\n                    );\n\n                    response = createResponseMessage(\n                        requestId,\n                        transformedResult,\n                        this.#peerId,\n                        true\n                    );\n                } catch (/** @type {any} */ error) {\n                    response = createResponseMessage(\n                        requestId,\n                        null,\n                        this.#peerId,\n                        false,\n                        {\n                            code: error.code ?? ErrorCode.HANDLER_ERROR,\n                            message: error.message\n                        }\n                    );\n                }\n            }\n        }\n\n        // Send response\n        if (replyFn) {\n            replyFn(response);\n        } else if (peerId) {\n            this.#router.route({ target: peerId, payload: response });\n        }\n    }\n\n    /**\n     * Handles incoming response.\n     * \n     */\n    #handleResponse(requestId, success, data, error) {\n        this.#pendingRequests.resolve(requestId, {\n            requestId,\n            success,\n            data,\n            error\n        });\n    }\n\n    /**\n     * Asserts the bus is not destroyed.\n     * \n     */\n    #assertNotDestroyed() {\n        if (this.#destroyed) {\n            throw CrossBusError.from(ErrorCode.DESTROYED, {\n                context: 'CrossBus operation'\n            });\n        }\n    }\n\n    /**\n     * Runs a chain of hooks on a payload.\n     * \n     */\n    async #runHooks(hooks, payload, context) {\n        let current = payload;\n        for (const { fn } of hooks) {\n            try {\n                current = await fn(current, context);\n            } catch (error) {\n                console.error('[CrossBus] Hook error:', error);\n                // Continue with unmodified payload on error\n            }\n        }\n        return current;\n    }\n\n    // \n    // Security Methods\n    // \n\n    /**\n     * Emits security warnings in development mode.\n     * @param {CrossBusOptions} options\n     */\n    #emitSecurityWarnings(options) {\n        // Only warn in development\n        const isDev = typeof process !== 'undefined'\n            ? process.env?.NODE_ENV !== 'production'\n            : typeof window !== 'undefined' && window.location?.hostname === 'localhost';\n\n        if (!isDev) return;\n\n        // Warn if allowedOrigins is not specified\n        if (!options.allowedOrigins || options.allowedOrigins.length === 0) {\n            console.warn(\n                '[CrossBus Security]  No allowedOrigins specified.\\n' +\n                'This bus will REJECT all incoming messages from transports.\\n' +\n                'To receive messages, specify allowed origins:\\n' +\n                '  allowedOrigins: [\"https://trusted-domain.com\"]\\n' +\n                'For development only: allowedOrigins: [\"*\"]'\n            );\n        }\n\n        // Warn about wildcard origins\n        if (options.allowedOrigins?.includes('*')) {\n            console.warn(\n                '[CrossBus Security]  allowedOrigins: [\"*\"] accepts messages from ANY origin.\\n' +\n                'This is INSECURE in production. Use specific origins instead:\\n' +\n                '  allowedOrigins: [\"https://trusted-domain.com\"]\\n' +\n                'For production, use:\\n' +\n                '  CrossBus.createSecure({ allowedOrigins: [\"https://...\"] })\\n' +\n                'Suppress this warning with NODE_ENV=production'\n            );\n\n            // In strict mode, throw error\n            if (this.#strictMode) {\n                throw new Error(\n                    'strictMode: allowedOrigins: [\"*\"] is not allowed. ' +\n                    'Use specific origins for security.'\n                );\n            }\n        }\n    }\n\n    /**\n     * Checks handler security before execution.\n     * @param {string} handlerName\n     * @param {string} peerId\n     * @param {*} payload\n     * @returns {{ allowed: boolean, error?: CrossBusError }}\n     */\n    #checkHandlerSecurity(handlerName, peerId, payload) {\n        const options = this.#handlerOptions.get(handlerName);\n        if (!options) {\n            return { allowed: true };\n        }\n\n        // Check peer allowlist\n        if (options.allowedPeers && !options.allowedPeers.includes(peerId)) {\n            return {\n                allowed: false,\n                error: CrossBusError.from(ErrorCode.UNAUTHORIZED, {\n                    handler: handlerName,\n                    peer: peerId,\n                    allowedPeers: options.allowedPeers\n                })\n            };\n        }\n\n        // Check rate limit\n        if (options.rateLimit) {\n            const limitKey = `${handlerName}:${peerId}`;\n            if (!this.#checkRateLimit(limitKey, options.rateLimit)) {\n                return {\n                    allowed: false,\n                    error: CrossBusError.from(ErrorCode.RATE_LIMITED, {\n                        handler: handlerName,\n                        peer: peerId,\n                        limit: options.rateLimit\n                    })\n                };\n            }\n        }\n\n        // Validate payload\n        if (options.validatePayload) {\n            try {\n                const isValid = options.validatePayload(payload);\n                if (!isValid) {\n                    return {\n                        allowed: false,\n                        error: CrossBusError.from(ErrorCode.INVALID_PAYLOAD, {\n                            handler: handlerName\n                        })\n                    };\n                }\n            } catch (/** @type {any} */ e) {\n                return {\n                    allowed: false,\n                    error: CrossBusError.from(ErrorCode.INVALID_PAYLOAD, {\n                        handler: handlerName,\n                        reason: e?.message ?? 'Validation error'\n                    })\n                };\n            }\n        }\n\n        return { allowed: true };\n    }\n\n    /**\n     * Checks rate limit for a key.\n     * @param {string} key - Rate limit key (e.g., \"handlerName:peerId\")\n     * @param {number} maxPerSecond - Maximum calls per second\n     * @returns {boolean} - True if allowed, false if rate limited\n     */\n    #checkRateLimit(key, maxPerSecond) {\n        const now = Date.now();\n        const counter = this.#rateLimitCounters.get(key);\n\n        if (!counter || now >= counter.resetAt) {\n            // Start new window\n            this.#rateLimitCounters.set(key, {\n                count: 1,\n                resetAt: now + 1000\n            });\n            return true;\n        }\n\n        if (counter.count >= maxPerSecond) {\n            return false;\n        }\n\n        counter.count++;\n        return true;\n    }\n\n\n\n    /**\n     * Gets the maximum payload size.\n     * @returns {number}\n     */\n    get maxPayloadSize() {\n        return this.#maxPayloadSize;\n    }\n\n    /**\n     * Gets whether strict mode is enabled.\n     * @returns {boolean}\n     */\n    get strictMode() {\n        return this.#strictMode;\n    }\n\n    /**\n     * Gets whether debug mode is enabled.\n     * @returns {boolean}\n     */\n    get debug() {\n        return this.#debug;\n    }\n\n    /**\n     * Gets the uptime in milliseconds.\n     * @returns {number}\n     */\n    get uptime() {\n        return Date.now() - this.#createdAt;\n    }\n\n    // \n    // Debug Logging\n    // \n\n    /**\n     * Logs a debug message if debug mode is enabled.\n     * @param {'in'|'out'|'info'|'warn'|'error'} type - Log type\n     * @param {string} message - Message to log\n     */\n    #log(type, message) {\n        if (!this.#debug) return;\n\n        const arrow = type === 'out' ? '' :\n            type === 'in' ? '' :\n                type === 'warn' ? '' :\n                    type === 'error' ? '' : '';\n\n        // eslint-disable-next-line no-console\n        console.log(`${this.#debugPrefix} ${arrow} ${message}`);\n    }\n\n    // \n    // Health Check\n    // \n\n    /**\n     * Returns the health status of the CrossBus instance.\n     * Useful for monitoring and diagnostics.\n     * \n     * @returns {Object} Health status object\n     * \n     * @example\n     * const health = bus.healthCheck();\n     * // {\n     * //   status: 'healthy',\n     * //   peerId: 'hub-1',\n     * //   uptime: 123456,\n     * //   peers: { total: 5, connected: 4 },\n     * //   handlers: ['getData', 'setData'],\n     * //   memory: { heapUsed: 12345678 }\n     * // }\n     */\n    healthCheck() {\n        const peerIds = this.#router.getPeerIds();\n        const connectedCount = peerIds.length;\n\n        // Determine status\n        let status = 'healthy';\n        if (this.#destroyed) {\n            status = 'unhealthy';\n        } else if (connectedCount === 0 && this.#isHub) {\n            status = 'degraded';\n        }\n\n        // Get memory usage if available\n        let memory;\n        if (typeof process !== 'undefined' && process.memoryUsage) {\n            try {\n                const mem = process.memoryUsage();\n                memory = {\n                    heapUsed: mem.heapUsed,\n                    heapTotal: mem.heapTotal,\n                    rss: mem.rss\n                };\n            } catch {\n                // Memory info not available\n            }\n        }\n\n        return {\n            status,\n            peerId: this.#peerId,\n            isHub: this.#isHub,\n            uptime: this.uptime,\n            peers: {\n                total: connectedCount,\n                ids: peerIds\n            },\n            handlers: Array.from(this.#handlers.keys()),\n            pendingRequests: this.#pendingRequests.size ?? 0,\n            destroyed: this.#destroyed,\n            ...(memory && { memory })\n        };\n    }\n\n    // \n    // Static Factory Methods\n    // \n\n    /**\n     * Creates a pre-configured secure CrossBus instance.\n     * Recommended for production use by AI agents.\n     * \n     * Enforces:\n     * - strictMode (no wildcard origins)\n     * - 1MB max payload size\n     * - 100 max pending requests\n     * - 30s request timeout\n     * \n     * @param {CrossBusOptions} options - Configuration options\n     * @returns {CrossBus} Configured instance\n     * @throws {Error} If allowedOrigins contains '*' or is missing\n     * \n     * @example\n     * // For production use\n     * const hub = CrossBus.createSecure({\n     *   peerId: 'my-hub',\n     *   isHub: true,\n     *   allowedOrigins: ['https://trusted-domain.com']\n     * });\n     */\n    static createSecure(options = {}) {\n        if (!options.allowedOrigins || options.allowedOrigins.length === 0) {\n            throw new Error(\n                'createSecure() requires allowedOrigins to be specified. ' +\n                'For development, use: new CrossBus({ allowedOrigins: [\"*\"] })'\n            );\n        }\n\n        if (options.allowedOrigins.includes('*')) {\n            throw new Error(\n                'createSecure() does not allow wildcard origins. ' +\n                'Specify exact origins: allowedOrigins: [\"https://example.com\"]'\n            );\n        }\n\n        return new CrossBus({\n            strictMode: true,\n            maxPayloadSize: 1024 * 1024,\n            maxPendingRequests: 100,\n            requestTimeout: 30000,\n            ...options\n        });\n    }\n\n    // \n    // Diagnostics (AI Agent Helper)\n    // \n\n    /**\n     * Performs diagnostics and returns troubleshooting suggestions.\n     * Designed to help AI agents identify and fix common issues.\n     * \n     * @returns {Object} Diagnostic report with issues and suggestions\n     * \n     * @example\n     * const report = bus.diagnose();\n     * if (report.issues.length > 0) {\n     *   console.log('Issues found:', report.issues);\n     *   console.log('Suggestions:', report.suggestions);\n     * }\n     */\n    diagnose() {\n        const issues = [];\n        const suggestions = [];\n        const warnings = [];\n\n        // Check if destroyed\n        if (this.#destroyed) {\n            issues.push('Instance is destroyed');\n            suggestions.push('Create a new CrossBus instance');\n            return { status: 'error', issues, suggestions, warnings };\n        }\n\n        // Check peer connections\n        const peerCount = this.#router.getPeerIds().length;\n        if (peerCount === 0) {\n            if (this.#isHub) {\n                warnings.push('Hub has no connected peers');\n                suggestions.push('Add transports with addTransport() or wait for agents to connect');\n            } else {\n                issues.push('Agent has no connected peers');\n                suggestions.push('Add a transport to connect to hub: bus.addTransport(transport, {peerId: \"hub\"})');\n            }\n        }\n\n        // Check handlers\n        const handlerCount = this.#handlers.size;\n        if (this.#isHub && handlerCount === 0) {\n            warnings.push('Hub has no registered handlers');\n            suggestions.push('Register handlers with bus.handle(\"name\", fn)');\n        }\n\n        // Check pending requests\n        const pendingCount = this.#pendingRequests.size ?? 0;\n        if (pendingCount > this.#maxPendingRequests * 0.8) {\n            warnings.push(`High pending request count: ${pendingCount}/${this.#maxPendingRequests}`);\n            suggestions.push('Consider increasing maxPendingRequests or check for slow handlers');\n        }\n\n        // Check strict mode in production hints\n        if (!this.#strictMode) {\n            warnings.push('strictMode is disabled');\n            suggestions.push('For production, use CrossBus.createSecure() or set strictMode: true');\n        }\n\n        // Determine overall status\n        let status = 'healthy';\n        if (issues.length > 0) {\n            status = 'error';\n        } else if (warnings.length > 0) {\n            status = 'warning';\n        }\n\n        return {\n            status,\n            peerId: this.#peerId,\n            isHub: this.#isHub,\n            peerCount,\n            handlerCount,\n            pendingRequests: pendingCount,\n            uptime: this.uptime,\n            issues,\n            warnings,\n            suggestions\n        };\n    }\n}\n"],"names":["PROTOCOL_PREFIX"],"mappings":"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,IAAI,CAAC,SAAS,GAAG,IAAI;AACjC,YAAY;AACZ,QAAQ;;AAER;AACA,QAAQ,IAAI,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;AAClC,YAAY,MAAM,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC;AACvD,YAAY,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC;AACxC,QAAQ,CAAC,MAAM;AACf;AACA,YAAY,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC;AAC1C,QAAQ;AACR,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,cAAc,CAAC,OAAO,EAAE;AAC5B;AACA,QAAQ,MAAM,OAAO,GAAG;AACxB,aAAa,OAAO,CAAC,oBAAoB,EAAE,MAAM;AACjD;AACA;AACA,aAAa,OAAO,CAAC,KAAK,EAAE,sBAAsB,CAAC;;AAEnD,QAAQ,OAAO,IAAI,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC;AACzC,IAAI;AACJ;;AC5MA;AACA;AACA;AACA;AACA;;;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAM,QAAQ,SAAS,YAAY,CAAC;AAC3C;AACA,IAAI,OAAO;;AAEX;AACA,IAAI,MAAM;;AAEV;AACA,I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"}